{
  "topic_title": "Authentication Header (AH) Protocol",
  "category": "001_Cryptography - 001_Cryptographic Protocols",
  "flashcards": [
    {
      "question_text": "What is the primary security service provided by the Authentication Header (AH) protocol within the IPsec suite?",
      "correct_answer": "Data origin authentication and integrity protection for IP packets.",
      "distractors": [
        {
          "text": "Confidentiality of the packet payload through encryption.",
          "misconception": "Targets [confidentiality vs integrity confusion]: Students may confuse AH with ESP, which provides confidentiality."
        },
        {
          "text": "Key exchange and management between IPsec peers.",
          "misconception": "Targets [protocol function confusion]: Students might mistake AH for a key management protocol like IKE."
        },
        {
          "text": "Protection against replay attacks by sequence numbering.",
          "misconception": "Targets [specific attack mitigation confusion]: While AH includes sequence numbers, this is a component of integrity, not its sole primary purpose."
        }
      ],
      "detailed_explanation": {
        "core_logic": "AH ensures data origin authentication and integrity by calculating an Integrity Check Value (ICV) over packet headers and data, preventing tampering. It does not provide confidentiality.",
        "distractor_analysis": "The first distractor incorrectly attributes confidentiality to AH, confusing it with ESP. The second distractor misidentifies AH's role, confusing it with key exchange protocols. The third focuses on a sub-feature (replay protection) as the primary service.",
        "analogy": "Think of AH as a tamper-evident seal on a package. It proves the package hasn't been opened or altered since it was sealed, and it shows who originally sealed it, but it doesn't hide what's inside."
      },
      "code_snippets": [],
      "difficulty": "foundational",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "IPSEC_BASICS",
        "CRYPTO_INTEGRITY",
        "CRYPTO_AUTHENTICATION"
      ]
    },
    {
      "question_text": "Which part of the IP packet does the Authentication Header (AH) protocol protect to ensure integrity?",
      "correct_answer": "The IP header (excluding mutable fields like IP addresses and TTL) and the IP payload.",
      "distractors": [
        {
          "text": "Only the IP payload, ensuring the data content is protected.",
          "misconception": "Targets [payload-only protection confusion]: Students may think AH only protects the data, similar to how some application-layer security might focus solely on the message body."
        },
        {
          "text": "The entire IP header, including mutable fields like source and destination IP addresses.",
          "misconception": "Targets [mutable field handling confusion]: Students might not realize that AH specifically excludes fields that change in transit."
        },
        {
          "text": "Only the TCP or UDP header, as these contain critical port information.",
          "misconception": "Targets [layer confusion]: Students might incorrectly assume AH operates at the transport layer and focuses on its headers."
        }
      ],
      "detailed_explanation": {
        "core_logic": "AH calculates an Integrity Check Value (ICV) over a significant portion of the IP packet, including most of the IP header and the entire payload. This ensures that any modification to these parts is detectable.",
        "distractor_analysis": "The first distractor incorrectly limits protection to the payload. The second distractor fails to account for AH's exclusion of mutable header fields. The third distractor wrongly places AH's focus on transport layer headers.",
        "analogy": "AH acts like a notary public verifying a document. It checks the main body of the document and the sender's identification (header), but it doesn't change the sender's address if the package is rerouted (mutable fields)."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "IPSEC_AH_PACKET_STRUCTURE",
        "IP_PACKET_STRUCTURE",
        "CRYPTO_INTEGRITY"
      ]
    },
    {
      "question_text": "Why does the Authentication Header (AH) protocol exclude certain fields in the IP header from its integrity calculation?",
      "correct_answer": "To allow for legitimate modifications to these fields by network devices (e.g., routers changing TTL) without invalidating the integrity check.",
      "distractors": [
        {
          "text": "These fields are considered less critical for overall packet security.",
          "misconception": "Targets [criticality assessment confusion]: Students might assume all header fields are equally important for integrity."
        },
        {
          "text": "The protocol designers did not have the computational power to include them in 1998.",
          "misconception": "Targets [historical/performance limitation confusion]: Students might attribute design choices to outdated technology rather than functional necessity."
        },
        {
          "text": "These fields are encrypted by the Encapsulating Security Payload (ESP) protocol.",
          "misconception": "Targets [protocol interaction confusion]: Students might incorrectly assume AH relies on ESP for header protection or that ESP encrypts these specific fields."
        }
      ],
      "detailed_explanation": {
        "core_logic": "AH excludes mutable fields like the Time To Live (TTL) because they are expected to change in transit due to network routing. Including them would cause legitimate packets to fail integrity checks, breaking network functionality.",
        "distractor_analysis": "The first distractor oversimplifies the reason, ignoring the functional necessity. The second distractor incorrectly attributes the design to historical limitations. The third distractor wrongly links AH's exclusion to ESP's encryption.",
        "analogy": "Imagine sending a package with a tracking number. The tracking number (mutable field) changes as it moves through different depots. AH ensures the original sender's address and the contents are intact, but it doesn't worry about the tracking number changing."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "IPSEC_AH_MUTABLE_FIELDS",
        "IP_PACKET_ROUTING",
        "CRYPTO_INTEGRITY"
      ]
    },
    {
      "question_text": "What is the role of the Security Parameters Index (SPI) in the Authentication Header (AH)?",
      "correct_answer": "It helps the receiving system identify the correct Security Association (SA) to use for processing the AH-protected packet.",
      "distractors": [
        {
          "text": "It encrypts the packet payload to ensure confidentiality.",
          "misconception": "Targets [SPI function confusion]: Students may think SPI is involved in encryption, confusing it with cryptographic keys or algorithms."
        },
        {
          "text": "It provides a sequence number to prevent replay attacks.",
          "misconception": "Targets [SPI vs Sequence Number confusion]: Students might confuse the SPI with the sequence number field, which serves the replay protection function."
        },
        {
          "text": "It indicates the type of cryptographic algorithm used for integrity.",
          "misconception": "Targets [SPI vs Algorithm Identifier confusion]: Students might think SPI directly specifies the algorithm, rather than identifying the SA which implicitly defines the algorithm."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The SPI, along with the destination IP address and the protocol (AH or ESP), uniquely identifies the Security Association (SA) for a given packet. This allows the receiver to apply the correct security policy and cryptographic algorithms.",
        "distractor_analysis": "The first distractor wrongly assigns an encryption role to the SPI. The second distractor confuses the SPI with the sequence number field. The third distractor incorrectly states that SPI directly indicates the algorithm.",
        "analogy": "The SPI is like a reference number on a work order. When a package arrives, the SPI tells the receiving department which specific set of instructions (Security Association) to follow for processing it."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "IPSEC_SA",
        "IPSEC_AH_PACKET_STRUCTURE",
        "CRYPTO_PROTOCOLS"
      ]
    },
    {
      "question_text": "How does the Authentication Header (AH) protocol protect against replay attacks?",
      "correct_answer": "By including a monotonically increasing sequence number in each packet, which the receiver checks against previously seen numbers.",
      "distractors": [
        {
          "text": "By encrypting the packet payload, making it impossible to resend validly.",
          "misconception": "Targets [encryption vs sequence number confusion]: Students may believe encryption inherently prevents replay, or confuse AH's function with ESP's."
        },
        {
          "text": "By using a unique, randomly generated nonce for each packet.",
          "misconception": "Targets [nonce vs sequence number confusion]: Students might confuse the purpose of nonces (uniqueness) with sequence numbers (order)."
        },
        {
          "text": "By performing a challenge-response authentication for every packet.",
          "misconception": "Targets [authentication mechanism confusion]: Students might assume a more complex authentication method is used for replay protection."
        }
      ],
      "detailed_explanation": {
        "core_logic": "AH uses a sequence number field that increments with each packet sent under a specific Security Association (SA). The receiver maintains a state for each SA and rejects packets with sequence numbers that are too old or duplicates, thus preventing replay attacks.",
        "distractor_analysis": "The first distractor incorrectly attributes encryption to AH and its replay protection. The second distractor confuses the sequence number mechanism with the use of nonces. The third distractor suggests a different, more complex authentication method.",
        "analogy": "It's like numbered tickets for a raffle. Each ticket has a unique, increasing number. If someone tries to use an old ticket number or a duplicate, it's immediately recognized as invalid."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "procedure",
      "bloom_level": "apply",
      "prerequisites": [
        "IPSEC_AH_SEQUENCE_NUMBER",
        "CRYPTO_REPLAY_ATTACK",
        "IPSEC_SA"
      ]
    },
    {
      "question_text": "In which IPsec mode does the Authentication Header (AH) protocol operate?",
      "correct_answer": "Transport mode and Tunnel mode.",
      "distractors": [
        {
          "text": "Only in Transport mode, protecting end-to-end communication.",
          "misconception": "Targets [mode limitation confusion]: Students might incorrectly assume AH is only for end-to-end security and not network-to-network."
        },
        {
          "text": "Only in Tunnel mode, encapsulating entire original IP packets.",
          "misconception": "Targets [mode limitation confusion]: Students might incorrectly associate AH's header protection with the encapsulation aspect of tunnel mode."
        },
        {
          "text": "Neither mode; AH is a separate protocol not integrated with IPsec modes.",
          "misconception": "Targets [protocol integration confusion]: Students may not understand that AH is a core component of the IPsec suite."
        }
      ],
      "detailed_explanation": {
        "core_logic": "AH can be used in both IPsec Transport Mode, where it protects the original IP header and payload, and Tunnel Mode, where it protects a new IP header along with the original IP packet (including its header and payload).",
        "distractor_analysis": "The first and second distractors incorrectly limit AH's applicability to only one of the IPsec modes. The third distractor fundamentally misunderstands AH's relationship with IPsec.",
        "analogy": "AH can work like a security sticker on a letter (Transport Mode) or like a security seal around a whole box containing a letter (Tunnel Mode). Both protect the contents and sender identity, just at different levels."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "IPSEC_MODES",
        "IPSEC_AH"
      ]
    },
    {
      "question_text": "What is the primary drawback of using the Authentication Header (AH) protocol compared to the Encapsulating Security Payload (ESP) protocol?",
      "correct_answer": "AH does not provide confidentiality (encryption) for the packet payload.",
      "distractors": [
        {
          "text": "AH is significantly slower due to its complex integrity algorithms.",
          "misconception": "Targets [performance comparison confusion]: Students might assume integrity checks are always more computationally expensive than encryption, or vice versa."
        },
        {
          "text": "AH cannot protect against replay attacks, unlike ESP.",
          "misconception": "Targets [feature comparison confusion]: Students may incorrectly believe ESP offers replay protection while AH does not."
        },
        {
          "text": "AH is only compatible with IPv4 and not IPv6.",
          "misconception": "Targets [protocol compatibility confusion]: Students might have outdated information or confuse AH's compatibility with other network protocols."
        }
      ],
      "detailed_explanation": {
        "core_logic": "While both AH and ESP provide integrity and authentication, ESP additionally offers optional confidentiality through encryption. AH's sole focus is on integrity and authentication, leaving the payload exposed.",
        "distractor_analysis": "The first distractor makes an unsubstantiated claim about AH's performance relative to ESP. The second distractor incorrectly states AH doesn't protect against replay attacks. The third distractor is factually incorrect regarding IPv6 compatibility.",
        "analogy": "AH is like a signed affidavit confirming who wrote a document and that it hasn't been changed. ESP is like that affidavit, but also placed inside a locked box, hiding the document's contents."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "comparison",
      "bloom_level": "analyze",
      "prerequisites": [
        "IPSEC_AH_VS_ESP",
        "CRYPTO_CONFIDENTIALITY",
        "CRYPTO_INTEGRITY"
      ]
    },
    {
      "question_text": "Which RFC specifies the current cryptographic algorithm implementation requirements and usage guidance for AH and ESP?",
      "correct_answer": "RFC 7321",
      "distractors": [
        {
          "text": "RFC 2402",
          "misconception": "Targets [outdated standard confusion]: RFC 2402 originally defined AH but has been obsoleted by RFC 7321 for algorithm requirements."
        },
        {
          "text": "RFC 7634",
          "misconception": "Targets [related but different standard confusion]: RFC 7634 discusses ChaCha20/Poly1305 for IKEv2/IPsec, but RFC 7321 is the primary requirements document for AH/ESP algorithms."
        },
        {
          "text": "NIST SP 800-77",
          "misconception": "Targets [non-RFC standard confusion]: NIST provides guidance, but RFC 7321 is the IETF standard for AH/ESP algorithm requirements."
        }
      ],
      "detailed_explanation": {
        "core_logic": "RFC 7321 updates and provides guidance on cryptographic algorithms for AH and ESP, superseding earlier documents like RFC 4835 and RFC 2402 regarding algorithm implementation requirements. [RFC 7321](https://datatracker.ietf.org/doc/html/rfc7321)",
        "distractor_analysis": "RFC 2402 is an older standard for AH itself but not the current algorithm requirements. RFC 7634 focuses on specific modern algorithms within IPsec. NIST SP 800-77 is relevant but not the primary IETF standard for AH/ESP algorithm requirements.",
        "analogy": "Think of RFC 7321 as the latest edition of a security manual for IPsec protocols, updating the specific tools (algorithms) and how to use them, while older manuals like RFC 2402 might describe the basic structure but not the current best practices for tools."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "definition",
      "bloom_level": "remember",
      "prerequisites": [
        "IPSEC_STANDARDS",
        "RFC_7321"
      ]
    },
    {
      "question_text": "Consider a scenario where data integrity and origin authentication are paramount, but the data itself is not sensitive and can be transmitted in cleartext. Which IPsec protocol would be most appropriate?",
      "correct_answer": "Authentication Header (AH) protocol.",
      "distractors": [
        {
          "text": "Encapsulating Security Payload (ESP) protocol with encryption disabled.",
          "misconception": "Targets [protocol feature confusion]: While ESP *can* be used without encryption, AH is specifically designed for integrity/authentication without confidentiality overhead."
        },
        {
          "text": "Internet Key Exchange (IKE) protocol.",
          "misconception": "Targets [protocol role confusion]: IKE is for establishing Security Associations (SAs), not for protecting individual data packets."
        },
        {
          "text": "Transport Layer Security (TLS) protocol.",
          "misconception": "Targets [layer confusion]: TLS operates at the application layer and is distinct from IPsec's network layer security."
        }
      ],
      "detailed_explanation": {
        "core_logic": "AH is purpose-built to provide data integrity and origin authentication without encrypting the payload, making it ideal when confidentiality is not a requirement. ESP can also provide these, but AH is the more direct choice for this specific need.",
        "distractor_analysis": "Using ESP without encryption is possible but less direct than AH for this specific requirement. IKE's role is key management, not data protection. TLS is a separate, application-layer protocol.",
        "analogy": "You need to send a document that must be proven to be from you and unaltered, but anyone can read it. AH is like sending it via certified mail with a return receipt â€“ it proves origin and integrity, but the content is visible."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "scenario",
      "bloom_level": "apply",
      "prerequisites": [
        "IPSEC_AH_USE_CASES",
        "IPSEC_ESP_USE_CASES",
        "CRYPTO_INTEGRITY",
        "CRYPTO_AUTHENTICATION"
      ]
    },
    {
      "question_text": "What is the 'Authentication Data' field in the AH packet format?",
      "correct_answer": "It contains the Integrity Check Value (ICV), which is the result of the integrity algorithm applied to the packet.",
      "distractors": [
        {
          "text": "It holds the symmetric encryption key used for the payload.",
          "misconception": "Targets [field function confusion]: Students may confuse AH fields with ESP encryption components or keying material."
        },
        {
          "text": "It is a digital signature created using the sender's private key.",
          "misconception": "Targets [signature vs ICV confusion]: While related to authentication, the ICV is typically generated using shared secrets or HMAC, not asymmetric signing in standard AH."
        },
        {
          "text": "It contains the sequence number for replay protection.",
          "misconception": "Targets [field mapping confusion]: Students might confuse the Authentication Data field with the separate Sequence Number field."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The Authentication Data field, often referred to as the Integrity Check Value (ICV) or hash, is generated by applying a specified integrity algorithm (e.g., HMAC-SHA1) to the protected parts of the packet. This value is then placed in this field for the receiver to verify.",
        "distractor_analysis": "The first distractor wrongly assigns an encryption key role. The second distractor incorrectly describes it as a digital signature generated with a private key. The third distractor confuses it with the sequence number field.",
        "analogy": "This field is like the checksum on a downloaded file. It's a calculated value that proves the file hasn't been corrupted during download, based on the file's content."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "IPSEC_AH_PACKET_STRUCTURE",
        "CRYPTO_INTEGRITY",
        "CRYPTO_HMAC"
      ]
    },
    {
      "question_text": "How does AH handle padding?",
      "correct_answer": "AH includes padding for alignment purposes and to pad the data to the size required by the integrity algorithm, with the padding length and padding type specified in adjacent fields.",
      "distractors": [
        {
          "text": "AH does not use padding, as it only protects headers and not the payload.",
          "misconception": "Targets [padding purpose confusion]: Students may incorrectly assume padding is only for payload encryption and not for algorithm requirements."
        },
        {
          "text": "Padding is used solely to obscure the true length of the original data.",
          "misconception": "Targets [padding motive confusion]: While padding can incidentally obscure length, its primary purpose in AH is algorithm alignment and integrity calculation."
        },
        {
          "text": "Padding is encrypted along with the payload by the ESP protocol.",
          "misconception": "Targets [protocol interaction confusion]: AH does not encrypt, and its padding is part of the integrity calculation, not ESP's encryption process."
        }
      ],
      "detailed_explanation": {
        "core_logic": "AH requires padding to ensure the data being authenticated is aligned to specific block boundaries required by certain integrity algorithms, and to ensure the integrity algorithm operates on a predictable amount of data. The padding length and type are specified in the AH header.",
        "distractor_analysis": "The first distractor is incorrect because AH does include padding. The second distractor misrepresents the primary purpose of padding in AH. The third distractor incorrectly links AH's padding to ESP's encryption.",
        "analogy": "Imagine needing to fit items into boxes of a specific size. You might add packing material (padding) to fill the box completely, even if the items themselves don't fill it, to ensure everything is secure and fits properly."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "IPSEC_AH_PADDING",
        "CRYPTO_ALGORITHMS",
        "CRYPTO_INTEGRITY"
      ]
    },
    {
      "question_text": "What is the relationship between the Authentication Header (AH) and the Encapsulating Security Payload (ESP) protocols within IPsec?",
      "correct_answer": "They are distinct protocols within IPsec that can be used independently or combined to provide different security services.",
      "distractors": [
        {
          "text": "AH is a mandatory component that must always be used alongside ESP.",
          "misconception": "Targets [protocol dependency confusion]: Students may think AH and ESP are always bundled or that one requires the other."
        },
        {
          "text": "ESP is an extension of AH, adding encryption capabilities to it.",
          "misconception": "Targets [protocol evolution confusion]: Students might incorrectly believe ESP evolved directly from AH by adding features."
        },
        {
          "text": "AH and ESP are interchangeable and provide identical security features.",
          "misconception": "Targets [protocol equivalence confusion]: Students may not recognize the distinct primary functions and optional features of each."
        }
      ],
      "detailed_explanation": {
        "core_logic": "AH focuses on integrity and authentication, while ESP focuses on confidentiality (encryption) and optionally integrity/authentication. They can be used together (e.g., tunnel mode with both) or separately, depending on the security requirements.",
        "distractor_analysis": "The first distractor incorrectly mandates their combined use. The second distractor misrepresents their developmental relationship. The third distractor wrongly equates their functionalities.",
        "analogy": "Think of AH as a 'signature required' service for mail, and ESP as a 'locked box' service. You can choose just signature, just a locked box, or both for maximum security."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "comparison",
      "bloom_level": "analyze",
      "prerequisites": [
        "IPSEC_AH_VS_ESP",
        "CRYPTO_PROTOCOLS"
      ]
    },
    {
      "question_text": "Which of the following is a potential security weakness if AH is used without ESP in certain network environments?",
      "correct_answer": "Exposure of sensitive payload data to eavesdropping.",
      "distractors": [
        {
          "text": "Increased susceptibility to denial-of-service (DoS) attacks.",
          "misconception": "Targets [attack vector confusion]: While IPsec can be a target, AH itself doesn't inherently increase DoS vulnerability compared to unencrypted traffic."
        },
        {
          "text": "Inability to detect modifications to the IP header.",
          "misconception": "Targets [AH protection scope confusion]: AH is designed to protect most of the IP header, contrary to this statement."
        },
        {
          "text": "Compromise of the integrity check value (ICV).",
          "misconception": "Targets [integrity mechanism confusion]: AH's integrity protection is robust if implemented correctly; compromising the ICV implies a break in the algorithm or implementation, not a weakness of AH's design principle."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Since AH does not provide encryption, any sensitive information within the IP packet's payload remains visible to anyone who can intercept the traffic. This is a significant weakness if confidentiality is required.",
        "distractor_analysis": "The first distractor makes a general claim about DoS attacks not specific to AH's lack of encryption. The second distractor is factually incorrect about AH's header protection scope. The third distractor points to implementation flaws rather than a design weakness of AH itself.",
        "analogy": "Using AH without ESP is like sending a postcard with a tamper-proof seal. The seal proves it wasn't opened, but anyone can read the message."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "IPSEC_AH_WEAKNESSES",
        "CRYPTO_CONFIDENTIALITY",
        "NETWORK_EAVESDROPPING"
      ]
    },
    {
      "question_text": "What is the purpose of the 'Next Header' field in the Authentication Header (AH)?",
      "correct_answer": "It indicates the type of protocol found in the payload following the AH header, allowing for proper processing.",
      "distractors": [
        {
          "text": "It specifies the encryption algorithm used for the payload.",
          "misconception": "Targets [field function confusion]: Students may confuse this field with fields related to encryption or algorithm specification."
        },
        {
          "text": "It contains the sequence number for replay protection.",
          "misconception": "Targets [field mapping confusion]: Students might confuse the Next Header field with the Sequence Number field."
        },
        {
          "text": "It identifies the Security Association (SA) for the packet.",
          "misconception": "Targets [field mapping confusion]: Students may confuse this field with the Security Parameters Index (SPI)."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The 'Next Header' field is crucial for demultiplexing protocols. It tells the receiving IP stack what protocol follows the current header (in this case, AH), enabling it to pass the payload to the correct handler (e.g., TCP, UDP, or another IPsec header).",
        "distractor_analysis": "The first distractor wrongly assigns an encryption role. The second and third distractors confuse the 'Next Header' field with other distinct fields within the IPsec headers (Sequence Number and SPI, respectively).",
        "analogy": "The 'Next Header' field is like the 'Contents' page in a book, indicating what type of chapter (protocol) comes next, so you know how to read it."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "IPSEC_AH_PACKET_STRUCTURE",
        "IP_PACKET_STRUCTURE",
        "NETWORK_PROTOCOLS"
      ]
    },
    {
      "question_text": "When AH is used in Tunnel Mode, what is encapsulated by the new IP header?",
      "correct_answer": "The entire original IP packet (including its header) along with the AH header.",
      "distractors": [
        {
          "text": "Only the payload of the original IP packet, with its original header discarded.",
          "misconception": "Targets [tunneling scope confusion]: Students may not understand that tunnel mode encapsulates the *entire* original packet, including its header."
        },
        {
          "text": "The original IP packet's payload and the AH header, but not the original IP header.",
          "misconception": "Targets [tunneling scope confusion]: Similar to the above, this misses that the original header is part of what's protected and encapsulated."
        },
        {
          "text": "Only the AH header and the original IP header, excluding the payload.",
          "misconception": "Targets [tunneling purpose confusion]: This misunderstands that the goal is to protect the original communication, including its data."
        }
      ],
      "detailed_explanation": {
        "core_logic": "In Tunnel Mode, IPsec creates a new IP header for routing across the network. The original IP packet (which includes its own header and payload) is treated as the payload for the new IP packet, and the AH header is inserted between the new IP header and the original packet.",
        "distractor_analysis": "All distractors incorrectly describe what is encapsulated. Tunnel mode's purpose is to protect the entire original packet, including its header, by encapsulating it within a new IP packet.",
        "analogy": "Tunnel Mode is like putting a sealed, original letter (original IP packet) inside a secure courier envelope (new IP packet with AH header). The entire original letter, including its address, is protected during transit."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "IPSEC_TUNNEL_MODE",
        "IPSEC_AH",
        "IP_PACKET_STRUCTURE"
      ]
    }
  ],
  "generation_metadata": {
    "model": "google/gemini-2.5-flash-lite",
    "num_generated": 15,
    "temperature": 0.1,
    "web_citations": [],
    "research_method": "openrouter_web_plugin",
    "search_query": "Authentication Header (AH) Protocol 001_Cryptography best practices",
    "latency_ms": 25689.832
  },
  "timestamp": "2026-01-18T16:32:14.922647"
}