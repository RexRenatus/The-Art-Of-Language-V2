{
  "topic_title": "Subject Alternative Name (SAN)",
  "category": "001_Cryptography - 005_Asymmetric 001_Cryptography",
  "flashcards": [
    {
      "question_text": "According to RFC 9525, what is the primary purpose of the Subject Alternative Name (SAN) extension in X.509 certificates used with TLS?",
      "correct_answer": "To specify the identity of the application service the certificate is intended for, allowing clients to verify the server's identity.",
      "distractors": [
        {
          "text": "To encrypt the server's private key for secure transmission.",
          "misconception": "Targets [encryption confusion]: Students who believe SAN is used for encrypting sensitive key material rather than identity verification."
        },
        {
          "text": "To provide a unique identifier for the Certificate Authority (CA) that issued the certificate.",
          "misconception": "Targets [issuer vs subject confusion]: Students who confuse the role of the SAN (subject identity) with the issuer's identity."
        },
        {
          "text": "To list all revoked certificates issued by the same CA.",
          "misconception": "Targets [CRL confusion]: Students who mix the purpose of SAN with Certificate Revocation Lists (CRLs)."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The SAN extension in X.509 certificates, as updated by RFC 9525, is crucial for TLS because it explicitly lists the hostnames or IP addresses a certificate is valid for, enabling clients to verify the server's identity and prevent man-in-the-middle attacks.",
        "distractor_analysis": "The first distractor incorrectly suggests SAN is for encryption. The second confuses the subject's identity with the issuer's. The third incorrectly associates SAN with certificate revocation.",
        "analogy": "Think of a SAN as the 'name tag' on a package. It clearly states who the package is for (e.g., 'example.com', '192.168.1.1'), ensuring it reaches the correct recipient and isn't intercepted by someone pretending to be that recipient."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "PKI_BASICS",
        "TLS_BASICS",
        "X509_CERTIFICATES"
      ]
    },
    {
      "question_text": "RFC 9525 obsoletes RFC 6125. What is a key change introduced by RFC 9525 regarding server identity verification in TLS?",
      "correct_answer": "It mandates that the <code>commonName</code> (CN) attribute in the certificate's Subject field should no longer be used as a fallback for server identity verification if SAN is present.",
      "distractors": [
        {
          "text": "It requires all servers to use only the <code>commonName</code> field for identity verification.",
          "misconception": "Targets [commonName deprecation]: Students who misunderstand the shift away from relying solely on CN."
        },
        {
          "text": "It allows the <code>commonName</code> field to be used alongside SAN for increased security.",
          "misconception": "Targets [SAN precedence]: Students who believe CN and SAN are equally valid or complementary for identity verification."
        },
        {
          "text": "It deprecates the use of SAN and promotes the <code>commonName</code> field as the primary identifier.",
          "misconception": "Targets [SAN vs commonName reversal]: Students who incorrectly reverse the roles and importance of SAN and CN."
        }
      ],
      "detailed_explanation": {
        "core_logic": "RFC 9525 updates TLS identity verification by deprecating the fallback use of the certificate's Subject <code>commonName</code> (CN) when a Subject Alternative Name (SAN) extension is present. This ensures more reliable and specific identity matching, as SAN can list multiple hostnames or IP addresses.",
        "distractor_analysis": "The first distractor incorrectly promotes CN. The second suggests a false equivalence between CN and SAN. The third reverses the deprecation trend.",
        "analogy": "Imagine a security guard checking IDs. Previously, they might accept a driver's license (commonName) if the person's name tag (SAN) was missing. RFC 9525 says: if the name tag is there, ignore the driver's license for verification purposes; the name tag is the definitive source."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "PKI_BASICS",
        "TLS_BASICS",
        "X509_CERTIFICATES",
        "RFC_6125"
      ]
    },
    {
      "question_text": "What is the primary security benefit of using the Subject Alternative Name (SAN) extension in X.509 certificates for TLS?",
      "correct_answer": "It prevents man-in-the-middle (MitM) attacks by ensuring the client connects to the intended server and not an imposter.",
      "distractors": [
        {
          "text": "It encrypts the communication channel, making eavesdropping impossible.",
          "misconception": "Targets [SAN vs encryption confusion]: Students who confuse identity verification with the encryption of the communication channel itself."
        },
        {
          "text": "It guarantees the integrity of the data transmitted between client and server.",
          "misconception": "Targets [SAN vs integrity confusion]: Students who believe SAN provides data integrity, which is handled by other TLS mechanisms."
        },
        {
          "text": "It allows for the use of weaker, faster encryption algorithms.",
          "misconception": "Targets [SAN vs algorithm selection]: Students who incorrectly associate SAN with the choice of encryption algorithms."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The SAN extension is critical for TLS security because it explicitly lists the valid identities (hostnames, IP addresses) for which a certificate is issued. This allows the client to verify that the server it's connecting to is the legitimate one, thereby preventing man-in-the-middle attacks.",
        "distractor_analysis": "The first distractor conflates identity verification with channel encryption. The second incorrectly attributes data integrity to SAN. The third wrongly links SAN to algorithm selection.",
        "analogy": "A SAN is like a verified list of authorized entry points for a secure facility. If you try to enter through a gate not on the list, security (the TLS client) will stop you, preventing unauthorized access (MitM attacks)."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "defense",
      "bloom_level": "apply",
      "prerequisites": [
        "PKI_BASICS",
        "TLS_BASICS",
        "MITM_ATTACKS"
      ]
    },
    {
      "question_text": "Which of the following is a valid type of entry that can be included in the Subject Alternative Name (SAN) extension of an X.509 certificate for a web server?",
      "correct_answer": "A fully qualified domain name (FQDN), such as 'www.example.com'.",
      "distractors": [
        {
          "text": "An IP address that is not publicly routable, like '192.168.1.100'.",
          "misconception": "Targets [IP address validity]: Students who believe private IP addresses are valid for public-facing server certificates."
        },
        {
          "text": "A generic description, such as 'Wildcard Certificate'.",
          "misconception": "Targets [descriptive text vs identifier]: Students who confuse descriptive labels with actual identifiers."
        },
        {
          "text": "The name of the Certificate Authority (CA) that issued the certificate.",
          "misconception": "Targets [subject vs issuer confusion]: Students who confuse the certificate's subject identity with the issuer's identity."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The Subject Alternative Name (SAN) extension allows for multiple identities to be bound to a single certificate. For web servers, this commonly includes Fully Qualified Domain Names (FQDNs) like 'www.example.com' and, when necessary, IP addresses, enabling a certificate to cover multiple hostnames or IPs.",
        "distractor_analysis": "The first distractor suggests private IPs are valid, which they are not for public TLS certificates. The second proposes a descriptive string instead of a specific identifier. The third confuses the certificate's subject with its issuer.",
        "analogy": "A SAN is like a list of aliases for a person. 'John Smith' (the certificate subject) might also go by 'Johnny' (a SAN FQDN) or 'J.S.' (another SAN FQDN), and all these names are officially recognized as referring to the same person."
      },
      "code_snippets": [],
      "difficulty": "foundational",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "PKI_BASICS",
        "X509_CERTIFICATES",
        "FQDN"
      ]
    },
    {
      "question_text": "What is the significance of the <code>dNSName</code> type within the Subject Alternative Name (SAN) extension?",
      "correct_answer": "It specifies a Domain Name System (DNS) hostname for which the certificate is valid.",
      "distractors": [
        {
          "text": "It indicates the Distinguished Name (DN) of the certificate's subject.",
          "misconception": "Targets [DN vs dNSName confusion]: Students who confuse the general Distinguished Name with the specific DNS hostname type."
        },
        {
          "text": "It represents a wildcard character used in domain names.",
          "misconception": "Targets [wildcard vs dNSName confusion]: Students who think `dNSName` itself implies wildcard usage, rather than just being a hostname."
        },
        {
          "text": "It defines the encryption algorithm used for the certificate.",
          "misconception": "Targets [SAN type vs algorithm]: Students who confuse identity types within SAN with cryptographic algorithms."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The <code>dNSName</code> type within the SAN extension is specifically designed to hold a DNS hostname. This allows a certificate to be valid for a particular domain name, such as 'mail.example.com', ensuring that TLS connections are established with the correct server.",
        "distractor_analysis": "The first distractor confuses the specific <code>dNSName</code> with the broader Distinguished Name. The second incorrectly equates <code>dNSName</code> with wildcard functionality. The third wrongly links a SAN type to encryption algorithms.",
        "analogy": "Think of <code>dNSName</code> as a specific field on a form labeled 'Website Address'. It's where you write down the exact web address (like 'www.example.com') that the certificate is meant for."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "PKI_BASICS",
        "X509_CERTIFICATES",
        "DNS"
      ]
    },
    {
      "question_text": "According to RFC 5280, what is the relationship between the certificate's Subject field and the Subject Alternative Name (SAN) extension?",
      "correct_answer": "The SAN extension provides a more flexible and extensible way to specify identities than the Subject field, and is preferred for server authentication.",
      "distractors": [
        {
          "text": "The Subject field is deprecated, and SAN is the only valid way to identify a certificate's subject.",
          "misconception": "Targets [Subject deprecation]: Students who believe the Subject field is entirely obsolete, rather than less preferred for certain uses."
        },
        {
          "text": "The SAN extension is used to identify the Certificate Authority (CA), while the Subject field identifies the end-entity.",
          "misconception": "Targets [Subject vs SAN role reversal]: Students who confuse the roles of the Subject and SAN extensions."
        },
        {
          "text": "The Subject field must always contain the same information as the primary SAN entry.",
          "misconception": "Targets [Subject/SAN equivalence]: Students who believe the Subject and SAN must be identical, ignoring SAN's flexibility."
        }
      ],
      "detailed_explanation": {
        "core_logic": "RFC 5280 defines the X.509 certificate structure, including the Subject field and the SAN extension. While the Subject field traditionally holds identity information (like a common name), the SAN extension offers a more robust and flexible mechanism to specify multiple identities (hostnames, IPs, etc.), making it the preferred method for server authentication in TLS.",
        "distractor_analysis": "The first distractor incorrectly states the Subject field is deprecated. The second reverses the roles of Subject and SAN. The third imposes a false requirement for equivalence between Subject and SAN.",
        "analogy": "The Subject field is like a person's legal name on their birth certificate. The SAN extension is like a list of all the other names they might use professionally or socially (e.g., nicknames, stage names). For official business (like TLS server authentication), the list of recognized names (SAN) is more practical and comprehensive."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "comparison",
      "bloom_level": "analyze",
      "prerequisites": [
        "PKI_BASICS",
        "X509_CERTIFICATES",
        "RFC_5280"
      ]
    },
    {
      "question_text": "Consider a scenario where a web server hosts multiple distinct websites (e.g., 'site1.example.com', 'site2.example.com') on the same IP address. How is the Subject Alternative Name (SAN) extension typically used to secure all these sites with a single certificate?",
      "correct_answer": "The SAN extension includes multiple <code>dNSName</code> entries, one for each distinct hostname ('site1.example.com', 'site2.example.com').",
      "distractors": [
        {
          "text": "A single wildcard entry, '*.example.com', is used to cover all subdomains.",
          "misconception": "Targets [wildcard limitations]: Students who assume wildcards cover all scenarios or don't understand specific hostname requirements."
        },
        {
          "text": "The certificate's Subject field lists all the hostnames, making SAN unnecessary.",
          "misconception": "Targets [Subject field limitations]: Students who believe the Subject field can adequately handle multiple hostnames."
        },
        {
          "text": "The server uses different certificates for each website, even if they share an IP.",
          "misconception": "Targets [single certificate efficiency]: Students who don't recognize the efficiency of using a single SAN certificate for multiple hostnames."
        }
      ],
      "detailed_explanation": {
        "core_logic": "To secure multiple distinct hostnames on a single server using one certificate, the SAN extension is populated with multiple <code>dNSName</code> entries, each corresponding to a specific hostname. This allows the TLS client to verify the certificate against the requested hostname, regardless of the shared IP address.",
        "distractor_analysis": "The first distractor suggests a wildcard, which might not cover all cases (e.g., different second-level domains) and isn't always preferred. The second incorrectly assumes the Subject field can handle multiple hostnames effectively. The third misses the efficiency benefit of using a single SAN certificate.",
        "analogy": "It's like a master key card that has access to multiple rooms (websites). Instead of needing a separate key for each room, one card (the SAN certificate) lists all the rooms it's authorized for."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "apply",
      "prerequisites": [
        "PKI_BASICS",
        "X509_CERTIFICATES",
        "TLS_BASICS",
        "MULTIPLE_HOSTNAMES"
      ]
    },
    {
      "question_text": "What is the purpose of the <code>iPAddress</code> type within the Subject Alternative Name (SAN) extension?",
      "correct_answer": "To associate an IP address with the certificate, allowing TLS connections to be secured for specific IP addresses.",
      "distractors": [
        {
          "text": "To provide the IP address of the Certificate Authority (CA).",
          "misconception": "Targets [IP address role confusion]: Students who confuse the certificate subject's IP with the CA's IP."
        },
        {
          "text": "To specify a range of IP addresses covered by the certificate.",
          "misconception": "Targets [IP range vs specific IP]: Students who believe SAN can cover IP ranges, rather than specific addresses."
        },
        {
          "text": "To encrypt the communication using the IP address as a key.",
          "misconception": "Targets [IP address as encryption key]: Students who misunderstand the function of IP addresses in cryptography."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The <code>iPAddress</code> type within the SAN extension allows a certificate to be explicitly associated with one or more IP addresses. This is useful when a server is identified by its IP address rather than a hostname, ensuring that TLS connections to that specific IP are secured by the certificate.",
        "distractor_analysis": "The first distractor incorrectly assigns the CA's IP to the SAN. The second wrongly suggests SAN covers IP ranges. The third misunderstands IP addresses as encryption keys.",
        "analogy": "Similar to <code>dNSName</code> for domain names, <code>iPAddress</code> in SAN is like writing a specific street address (e.g., '192.0.2.1') on the certificate, ensuring it's valid for anyone connecting directly to that numerical address."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "PKI_BASICS",
        "X509_CERTIFICATES",
        "IP_ADDRESSES"
      ]
    },
    {
      "question_text": "What is the potential security risk if a certificate's Subject Alternative Name (SAN) extension is not properly configured or validated by the client?",
      "correct_answer": "A client might connect to an imposter server that presents a certificate valid for a different hostname or IP address.",
      "distractors": [
        {
          "text": "The communication channel might be downgraded to a less secure encryption protocol.",
          "misconception": "Targets [SAN vs protocol negotiation]: Students who confuse identity verification with TLS protocol negotiation."
        },
        {
          "text": "The certificate's expiration date might be ignored, leading to acceptance of invalid certificates.",
          "misconception": "Targets [SAN vs expiration validation]: Students who mix SAN validation with certificate expiration checks."
        },
        {
          "text": "The Certificate Authority (CA) might be compromised, leading to issuance of fraudulent certificates.",
          "misconception": "Targets [SAN vs CA compromise]: Students who incorrectly link SAN misconfiguration directly to CA compromise."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Proper validation of the SAN extension is crucial because it ensures the client is connecting to the server it intended. If a client fails to validate the SAN against the requested hostname/IP, it could inadvertently connect to a malicious server impersonating the legitimate one, enabling man-in-the-middle attacks.",
        "distractor_analysis": "The first distractor incorrectly links SAN issues to protocol downgrades. The second confuses SAN validation with expiration checks. The third incorrectly attributes CA compromise to SAN misconfiguration.",
        "analogy": "If a security guard doesn't check the name tag (SAN) properly, they might let anyone into a restricted area, even someone using a fake ID (imposter server), because they didn't verify the name matched the authorized list."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "attack",
      "bloom_level": "analyze",
      "prerequisites": [
        "PKI_BASICS",
        "TLS_BASICS",
        "MITM_ATTACKS",
        "CERTIFICATE_VALIDATION"
      ]
    },
    {
      "question_text": "What does RFC 6818 clarify regarding the use of Internationalized Domain Names (IDNs) within X.509 certificates, particularly concerning the SAN extension?",
      "correct_answer": "It provides rules for converting internationalized domain name labels to ASCII (Punycode) for inclusion in certificates.",
      "distractors": [
        {
          "text": "It mandates that all domain names in SAN must be in their native language script.",
          "misconception": "Targets [IDN encoding requirement]: Students who misunderstand the need for ASCII compatibility in certificates."
        },
        {
          "text": "It deprecates the use of IDNs in SAN extensions altogether.",
          "misconception": "Targets [IDN deprecation]: Students who incorrectly believe IDNs are no longer supported."
        },
        {
          "text": "It requires SAN to only contain IP addresses, not domain names.",
          "misconception": "Targets [SAN content restriction]: Students who misunderstand the flexibility of SAN regarding domain names."
        }
      ],
      "detailed_explanation": {
        "core_logic": "RFC 6818 updates RFC 5280 and addresses the handling of Internationalized Domain Names (IDNs) in X.509 certificates. It clarifies that IDN labels should be converted to their ASCII representation (using Punycode) before being included in fields like the Subject Alternative Name (SAN) extension, ensuring compatibility with systems that only process ASCII domain names.",
        "distractor_analysis": "The first distractor suggests native script usage, contrary to ASCII requirements. The second incorrectly claims IDNs are deprecated. The third wrongly restricts SAN to only IP addresses.",
        "analogy": "When sending a letter to someone with a non-English name, you might need to write their name using the standard alphabet (ASCII/Punycode) so the postal service (certificate validation system) can read and deliver it correctly, even if their name is originally written differently."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "PKI_BASICS",
        "X509_CERTIFICATES",
        "IDN",
        "RFC_5280",
        "RFC_6818"
      ]
    },
    {
      "question_text": "What is the role of the Subject Alternative Name (SAN) extension in securing wildcard domains (e.g., '*.example.com')?",
      "correct_answer": "A SAN entry of type <code>dNSName</code> with the value '*.example.com' can be used to validate certificates for multiple subdomains under 'example.com'.",
      "distractors": [
        {
          "text": "Wildcard SAN entries are not permitted in modern X.509 certificates.",
          "misconception": "Targets [wildcard prohibition]: Students who believe wildcards are entirely disallowed."
        },
        {
          "text": "Wildcard domains must be listed individually in the SAN extension.",
          "misconception": "Targets [wildcard vs individual listing]: Students who misunderstand how wildcards function."
        },
        {
          "text": "The Subject field, not SAN, is used to specify wildcard domains.",
          "misconception": "Targets [Subject vs SAN for wildcards]: Students who confuse which field handles wildcard domain specifications."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The SAN extension supports wildcard domain names, such as '*.example.com', using the <code>dNSName</code> type. This allows a single certificate to secure multiple subdomains (e.g., 'www.example.com', 'mail.example.com', 'api.example.com') without needing a separate certificate for each, provided the wildcard is correctly specified and validated.",
        "distractor_analysis": "The first distractor incorrectly claims wildcards are disallowed. The second misunderstands that a single wildcard entry covers multiple subdomains. The third wrongly assigns wildcard functionality to the Subject field.",
        "analogy": "A wildcard SAN entry is like a master key that opens all doors on a specific floor of a building (all subdomains of 'example.com'), rather than needing a separate key for each individual room (each subdomain)."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "PKI_BASICS",
        "X509_CERTIFICATES",
        "WILDCARD_DOMAINS"
      ]
    },
    {
      "question_text": "What is the primary recommendation from RFC 9525 regarding the use of the <code>commonName</code> (CN) attribute in the Subject field when SAN is present?",
      "correct_answer": "Clients should not use the <code>commonName</code> attribute for server identity verification if the SAN extension is present.",
      "distractors": [
        {
          "text": "Clients should prioritize the <code>commonName</code> attribute over the SAN extension.",
          "misconception": "Targets [CN precedence]: Students who believe CN is still the primary identifier."
        },
        {
          "text": "Clients should check both <code>commonName</code> and SAN and accept if either matches.",
          "misconception": "Targets [dual validation]: Students who think both fields should be checked independently and either is sufficient."
        },
        {
          "text": "The <code>commonName</code> attribute should be removed entirely from certificates.",
          "misconception": "Targets [CN removal]: Students who misunderstand that CN is deprecated for validation, not necessarily removed from the certificate structure."
        }
      ],
      "detailed_explanation": {
        "core_logic": "RFC 9525 explicitly updates the best practices for TLS server identity verification. It mandates that if a certificate contains a Subject Alternative Name (SAN) extension, clients MUST use the identities listed in the SAN for verification and MUST NOT fall back to using the <code>commonName</code> (CN) attribute in the Subject field.",
        "distractor_analysis": "The first distractor reverses the recommended priority. The second suggests a flawed validation logic. The third proposes an incorrect action regarding the CN attribute's existence.",
        "analogy": "If you have a verified list of authorized attendees (SAN) for an event, you should check that list. You shouldn't also check their old driver's license photo (CN) if it doesn't match the list, as the list is the definitive source."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "procedure",
      "bloom_level": "apply",
      "prerequisites": [
        "PKI_BASICS",
        "TLS_BASICS",
        "X509_CERTIFICATES",
        "RFC_9525"
      ]
    },
    {
      "question_text": "Which of the following is NOT a valid type of identity that can be specified within the Subject Alternative Name (SAN) extension according to RFC 5280?",
      "correct_answer": "A cryptographic hash of the server's public key.",
      "distractors": [
        {
          "text": "A Uniform Resource Identifier (URI), such as 'sip:user@example.com'.",
          "misconception": "Targets [URI type validity]: Students who incorrectly believe URIs are not supported in SAN."
        },
        {
          "text": "An IP address, such as '192.0.2.1'.",
          "misconception": "Targets [IP address type validity]: Students who incorrectly believe IP addresses are not supported in SAN."
        },
        {
          "text": "A Domain Name System (DNS) hostname, such as 'www.example.com'.",
          "misconception": "Targets [dNSName type validity]: Students who incorrectly believe DNS hostnames are not supported in SAN."
        }
      ],
      "detailed_explanation": {
        "core_logic": "RFC 5280 defines several types for the Subject Alternative Name (SAN) extension, including <code>dNSName</code> (for hostnames), <code>iPAddress</code>, <code>uniformResourceIdentifier</code> (URI), and others. A cryptographic hash of the public key is not a standard identity type defined for SAN; SAN is for identifying the *subject* (e.g., the server), not for representing cryptographic primitives directly.",
        "distractor_analysis": "The distractors represent valid SAN types (<code>URI</code>, <code>iPAddress</code>, <code>dNSName</code>), while the correct answer is an invalid type. This tests knowledge of the specific identity types supported by SAN.",
        "analogy": "Imagine a 'Contact Information' section on a form. You can list phone numbers (<code>iPAddress</code>), email addresses (<code>dNSName</code>), or website URLs (<code>URI</code>), but you wouldn't list a fingerprint (<code>cryptographic hash</code>) as a contact method."
      },
      "code_snippets": [],
      "difficulty": "foundational",
      "question_type": "definition",
      "bloom_level": "remember",
      "prerequisites": [
        "PKI_BASICS",
        "X509_CERTIFICATES",
        "RFC_5280"
      ]
    },
    {
      "question_text": "What is the purpose of the Extended Key Usage (EKU) extension in an X.509 certificate, and how does it relate to SAN?",
      "correct_answer": "EKU specifies the intended purposes of the certificate (e.g., server authentication, code signing), while SAN specifies the identities the certificate is valid for.",
      "distractors": [
        {
          "text": "EKU defines the encryption algorithm, and SAN defines the key length.",
          "misconception": "Targets [EKU/SAN vs crypto parameters]: Students who confuse purpose/identity fields with cryptographic parameters."
        },
        {
          "text": "EKU is used for wildcard domains, and SAN is used for specific IP addresses.",
          "misconception": "Targets [EKU/SAN role reversal]: Students who incorrectly assign roles related to domain/IP coverage."
        },
        {
          "text": "EKU and SAN are interchangeable fields used for server identity verification.",
          "misconception": "Targets [EKU/SAN interchangeability]: Students who believe these distinct extensions serve the same purpose."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The Extended Key Usage (EKU) extension in an X.509 certificate provides a way to indicate one or more purposes for which the certificate can be used (e.g., <code>serverAuth</code>, <code>clientAuth</code>, <code>codeSigning</code>). The Subject Alternative Name (SAN) extension, conversely, lists the specific identities (like hostnames or IP addresses) that the certificate is valid for. They serve distinct but complementary roles in certificate validation.",
        "distractor_analysis": "The first distractor wrongly equates EKU/SAN with encryption parameters. The second reverses their roles concerning domain/IP coverage. The third incorrectly suggests they are interchangeable.",
        "analogy": "EKU is like the 'Job Title' on a badge (e.g., 'Security Guard', 'Technician'), indicating what the person is authorized to do. SAN is like the 'Name and Department' on the badge ('John Doe, IT Department'), specifying who the badge belongs to and for which areas (websites/IPs) it's valid."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "analyze",
      "prerequisites": [
        "PKI_BASICS",
        "X509_CERTIFICATES",
        "EKU"
      ]
    },
    {
      "question_text": "RFC 9336 defines a general-purpose Document-Signing KeyPurposeId for the Extended Key Usage (EKU) extension. How does this relate to the concept of SAN?",
      "correct_answer": "EKU specifies the *purpose* (document signing), while SAN specifies the *identity* (e.g., the signer's name or organization) associated with the certificate for that purpose.",
      "distractors": [
        {
          "text": "SAN is used to list the documents being signed, while EKU identifies the signer.",
          "misconception": "Targets [SAN/EKU role reversal for signing]: Students who confuse what SAN and EKU identify in a signing context."
        },
        {
          "text": "Both EKU and SAN are used to specify the cryptographic algorithm for document signing.",
          "misconception": "Targets [EKU/SAN vs algorithm]: Students who incorrectly associate these identity/purpose fields with cryptographic algorithms."
        },
        {
          "text": "SAN is deprecated for document signing; only EKU is relevant.",
          "misconception": "Targets [SAN deprecation for signing]: Students who incorrectly believe SAN is irrelevant for document signing certificates."
        }
      ],
      "detailed_explanation": {
        "core_logic": "RFC 9336 introduces a specific EKU for document signing. This EKU indicates that the certificate is intended for signing documents. The Subject Alternative Name (SAN) extension, if present, would then identify the entity (person, organization) authorized to perform this signing action, providing the identity context for the certificate's purpose.",
        "distractor_analysis": "The first distractor reverses the roles of SAN and EKU in the context of document signing. The second incorrectly links both extensions to cryptographic algorithms. The third wrongly claims SAN is deprecated for this purpose.",
        "analogy": "For a 'Document Signing' EKU, the SAN is like the 'Authorized Signatory' line on a contract, specifying *who* is allowed to sign. The EKU itself is the 'Purpose' line, stating *why* the signature is valid (i.e., for document authentication)."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "comparison",
      "bloom_level": "analyze",
      "prerequisites": [
        "PKI_BASICS",
        "X509_CERTIFICATES",
        "EKU",
        "DOCUMENT_SIGNING",
        "RFC_9336"
      ]
    },
    {
      "question_text": "In the context of TLS server identity verification, what is the primary implication of a certificate containing only a <code>commonName</code> (CN) in the Subject field, but no SAN extension?",
      "correct_answer": "The client MUST use the <code>commonName</code> value to verify the server's identity against the requested hostname.",
      "distractors": [
        {
          "text": "The certificate is invalid and should be rejected by the client.",
          "misconception": "Targets [CN invalidity]: Students who believe CN is always invalid if SAN is absent."
        },
        {
          "text": "The client should ignore the <code>commonName</code> and attempt to connect without verifying identity.",
          "misconception": "Targets [identity verification omission]: Students who think no verification is needed if SAN is missing."
        },
        {
          "text": "The certificate is valid only for IP address connections, not hostnames.",
          "misconception": "Targets [CN vs IP address]: Students who confuse the role of CN with IP address identification."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Prior to the updates solidified in RFC 9525, when a certificate lacked a Subject Alternative Name (SAN) extension, the <code>commonName</code> (CN) in the Subject field was the primary identifier used for TLS server identity verification. Clients were expected to match the requested hostname against the CN value.",
        "distractor_analysis": "The first distractor incorrectly states the certificate is invalid. The second suggests omitting verification, which is insecure. The third wrongly limits CN's applicability to IP addresses.",
        "analogy": "If a guest list (SAN) is missing, the doorman (client) must rely on the name written on the invitation itself (CN) to check if the person is expected, even though the list would be a more reliable source."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "procedure",
      "bloom_level": "apply",
      "prerequisites": [
        "PKI_BASICS",
        "TLS_BASICS",
        "X509_CERTIFICATES",
        "RFC_6125"
      ]
    },
    {
      "question_text": "What is the primary advantage of using multiple <code>dNSName</code> entries within a single SAN extension compared to issuing separate certificates for each hostname?",
      "correct_answer": "It reduces the administrative overhead and cost associated with managing multiple certificates.",
      "distractors": [
        {
          "text": "It provides stronger encryption by combining multiple keys.",
          "misconception": "Targets [SAN vs encryption strength]: Students who confuse identity management with cryptographic strength."
        },
        {
          "text": "It eliminates the need for Certificate Revocation Lists (CRLs).",
          "misconception": "Targets [SAN vs CRLs]: Students who incorrectly associate SAN with certificate revocation mechanisms."
        },
        {
          "text": "It allows the use of weaker, self-signed certificates for subdomains.",
          "misconception": "Targets [SAN vs self-signed certs]: Students who misunderstand the relationship between SAN and certificate trust/issuance."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Using multiple <code>dNSName</code> entries within a single SAN extension allows one certificate to cover several hostnames (e.g., www.example.com, mail.example.com). This consolidation significantly reduces the complexity, cost, and administrative burden of obtaining, deploying, and renewing individual certificates for each hostname.",
        "distractor_analysis": "The first distractor wrongly links SAN consolidation to encryption strength. The second incorrectly claims it eliminates CRLs. The third suggests it enables weaker, self-signed certificates, which is contrary to standard practice.",
        "analogy": "Instead of buying a separate key for every room in your house (each hostname), you get one master key that opens all the doors you need (multiple hostnames via SAN). This is simpler and cheaper."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "PKI_BASICS",
        "X509_CERTIFICATES",
        "CERTIFICATE_MANAGEMENT"
      ]
    },
    {
      "question_text": "According to the IETF Internet-Draft 'Update to Verifying TLS Server Identities with X.509 Certificates' (draft-rsalz-use-san-01), what is the intended status of this document?",
      "correct_answer": "Standards Track",
      "distractors": [
        {
          "text": "Informational",
          "misconception": "Targets [document status]: Students who confuse different RFC publication statuses."
        },
        {
          "text": "Experimental",
          "misconception": "Targets [document status]: Students who confuse different RFC publication statuses."
        },
        {
          "text": "Best Current Practice (BCP)",
          "misconception": "Targets [document status]: Students who confuse different RFC publication statuses."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Internet-Drafts, like draft-rsalz-use-san-01, are working documents. The 'Intended Status' field indicates the progression towards becoming a formal RFC. 'Standards Track' signifies that the document aims to define or update Internet standards, which is the case for updates to TLS identity verification procedures.",
        "distractor_analysis": "The distractors represent other possible statuses for IETF documents (Informational, Experimental, BCP), testing the user's knowledge of the formal process and the specific status indicated for this draft.",
        "analogy": "Think of the 'Intended Status' like the stage of a building project. 'Standards Track' is like 'under construction with blueprints approved for final building', aiming to become a permanent structure (a published RFC standard)."
      },
      "code_snippets": [],
      "difficulty": "foundational",
      "question_type": "definition",
      "bloom_level": "remember",
      "prerequisites": [
        "IETF_PROCESS",
        "RFC_PROCESS"
      ]
    }
  ],
  "generation_metadata": {
    "model": "google/gemini-2.5-flash-lite",
    "num_generated": 18,
    "temperature": 0.1,
    "web_citations": [],
    "research_method": "openrouter_web_plugin",
    "search_query": "Subject Alternative Name (SAN) 001_Cryptography best practices",
    "latency_ms": 31631.369
  },
  "timestamp": "2026-01-18T15:55:15.827590"
}