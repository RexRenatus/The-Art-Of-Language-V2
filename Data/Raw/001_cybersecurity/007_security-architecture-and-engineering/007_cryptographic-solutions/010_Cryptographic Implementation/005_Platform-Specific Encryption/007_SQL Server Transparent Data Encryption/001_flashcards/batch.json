{
  "topic_title": "SQL Server Transparent Data Encryption",
  "category": "Security Architecture And Engineering - Cryptographic Solutions",
  "flashcards": [
    {
      "question_text": "What is the primary purpose of Transparent Data Encryption (TDE) in SQL Server?",
      "correct_answer": "To encrypt database files at rest, protecting data from unauthorized access to physical media.",
      "distractors": [
        {
          "text": "To encrypt data in transit between the client and the server.",
          "misconception": "Targets [scope confusion]: Confuses data at rest encryption with data in transit encryption (e.g., TLS)."
        },
        {
          "text": "To encrypt sensitive data within specific columns of a table.",
          "misconception": "Targets [granularity error]: Confuses TDE with column-level encryption."
        },
        {
          "text": "To provide authentication and authorization for database access.",
          "misconception": "Targets [functional overlap]: Confuses encryption with access control mechanisms."
        }
      ],
      "detailed_explanation": {
        "core_logic": "TDE encrypts the entire database's data and log files, protecting against physical theft because it encrypts data at rest. This is achieved by encrypting data pages when written to disk and decrypting them when loaded into memory.",
        "distractor_analysis": "The distractors incorrectly describe TDE's function by confusing it with data-in-transit encryption, column-level encryption, or access control mechanisms.",
        "analogy": "TDE is like putting your entire filing cabinet into a locked safe, ensuring that even if someone steals the cabinet, the contents are unreadable without the safe's key."
      },
      "code_snippets": [],
      "difficulty": "foundational",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "CRYPTO_BASICS"
      ]
    },
    {
      "question_text": "Which encryption algorithm is commonly used by TDE in SQL Server for encrypting data and log files?",
      "correct_answer": "AES (Advanced Encryption Standard)",
      "distractors": [
        {
          "text": "RSA (Rivest–Shamir–Adleman)",
          "misconception": "Targets [algorithm type confusion]: RSA is an asymmetric algorithm typically used for key exchange or digital signatures, not bulk data encryption."
        },
        {
          "text": "DES (Data Encryption Standard)",
          "misconception": "Targets [outdated algorithm]: DES is an older, less secure symmetric algorithm that has been largely superseded."
        },
        {
          "text": "MD5 (Message-Digest Algorithm 5)",
          "misconception": "Targets [hashing vs. encryption confusion]: MD5 is a hashing algorithm, not an encryption algorithm, and is considered cryptographically broken."
        }
      ],
      "detailed_explanation": {
        "core_logic": "SQL Server TDE primarily uses AES (Advanced Encryption Standard) for its symmetric encryption of data and log files because AES offers strong security and good performance. AES is a modern standard, unlike older algorithms like DES.",
        "distractor_analysis": "Distractors propose RSA (asymmetric), DES (outdated), and MD5 (hashing), all of which are incorrect for TDE's primary data encryption role.",
        "analogy": "AES is like a modern, high-security padlock for your data files, while DES is an older, weaker padlock, and RSA is more like a key to a secure vault where other keys are kept."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "CRYPTO_SYMMETRIC_ALGORITHMS"
      ]
    },
    {
      "question_text": "What is the role of the Database Encryption Key (DEK) in SQL Server TDE?",
      "correct_answer": "It is a symmetric key that encrypts the actual database data and log files.",
      "distractors": [
        {
          "text": "It is an asymmetric key used to protect the Service Master Key (SMK).",
          "misconception": "Targets [key type confusion]: The DEK is symmetric; asymmetric keys protect other keys or are used for signing."
        },
        {
          "text": "It is the primary key used to authenticate users to the database.",
          "misconception": "Targets [authentication vs. encryption confusion]: DEK is for data encryption, not user authentication."
        },
        {
          "text": "It is a certificate stored in the master database to manage TDE settings.",
          "misconception": "Targets [key management confusion]: Certificates manage keys, but the DEK itself encrypts the data."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The DEK is the symmetric key that directly encrypts the database's data and log pages. It is itself protected by a TDE protector (like a certificate or asymmetric key), ensuring that the DEK can be securely managed and accessed when needed.",
        "distractor_analysis": "Distractors misrepresent the DEK as an asymmetric key, an authentication mechanism, or a certificate for managing TDE settings, rather than the key that directly encrypts the data.",
        "analogy": "The DEK is like the specific key that unlocks and locks your individual file drawers (data pages), while the TDE protector is like the key to the master key cabinet where the drawer keys are stored."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "CRYPTO_SYMMETRIC_KEYS",
        "SQL_TDE_ARCHITECTURE"
      ]
    },
    {
      "question_text": "How is the Database Encryption Key (DEK) typically protected in SQL Server TDE?",
      "correct_answer": "By a certificate stored in the server's master database or an asymmetric key protected by an EKM module.",
      "distractors": [
        {
          "text": "By the Service Master Key (SMK) directly, without any intermediate keys.",
          "misconception": "Targets [encryption hierarchy error]: The SMK protects other keys, but the DEK is typically protected by a certificate or asymmetric key, not directly by SMK."
        },
        {
          "text": "By a password entered by the user each time the database is accessed.",
          "misconception": "Targets [manual key management error]: TDE aims for automatic decryption; manual password entry per access is not how it functions."
        },
        {
          "text": "By hashing the DEK with a salt derived from the database name.",
          "misconception": "Targets [hashing vs. encryption confusion]: Hashing is for integrity checks, not for protecting encryption keys for decryption."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The DEK is protected by a TDE protector, which is usually a certificate or an asymmetric key. These protectors are stored in the master database or managed by an Extensible 006_Key Management (EKM) module, providing a secure layer for the DEK. The SMK is higher in the hierarchy, protecting these protectors.",
        "distractor_analysis": "Distractors suggest direct SMK protection (incorrect hierarchy), manual password entry (defeats automation), or hashing (wrong cryptographic function).",
        "analogy": "The DEK is protected by a certificate (like a secure vault key) stored in the master database's vault, or by an external security system (EKM), not directly by the building's master key (SMK) or by requiring a password each time."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "definition",
      "bloom_level": "analyze",
      "prerequisites": [
        "SQL_TDE_ARCHITECTURE",
        "SQL_KEY_HIERARCHY"
      ]
    },
    {
      "question_text": "What is a critical security best practice immediately after enabling TDE on a SQL Server database?",
      "correct_answer": "Back up the certificate or asymmetric key that protects the DEK, along with its private key.",
      "distractors": [
        {
          "text": "Disable TDE on system databases like master and msdb.",
          "misconception": "Targets [misunderstanding of TDE scope]: TDE is not applicable to system databases; this action is irrelevant."
        },
        {
          "text": "Perform a full database backup and store it on a separate server.",
          "misconception": "Targets [incomplete recovery strategy]: While a full backup is good, it's insufficient without the encryption keys."
        },
        {
          "text": "Enable auditing for all TDE-related operations.",
          "misconception": "Targets [prioritization error]: Auditing is important, but key backup is a prerequisite for recovery, making it more critical immediately after enabling TDE."
        }
      ],
      "detailed_explanation": {
        "core_logic": "If the certificate or asymmetric key protecting the DEK is lost, the encrypted database becomes inaccessible. Therefore, backing up this key and its private key immediately after enabling TDE is crucial for recovery, as it's the only way to decrypt the data.",
        "distractor_analysis": "Distractors suggest irrelevant actions (disabling TDE on system DBs), incomplete recovery steps (backup without keys), or secondary security measures (auditing) instead of the primary recovery prerequisite.",
        "analogy": "After locking your valuable documents in a secure safe (TDE), the most critical first step is to make a copy of the safe's key and store it securely elsewhere, in case you lose the original."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "procedure",
      "bloom_level": "apply",
      "prerequisites": [
        "SQL_TDE_MANAGEMENT",
        "CRYPTO_KEY_MANAGEMENT"
      ]
    },
    {
      "question_text": "Which of the following statements about TDE and system databases in SQL Server is TRUE?",
      "correct_answer": "TDE cannot be directly enabled on system databases like <code>master</code>, <code>model</code>, or <code>msdb</code>.",
      "distractors": [
        {
          "text": "TDE is automatically enabled on all system databases when it's enabled on any user database.",
          "misconception": "Targets [scope misunderstanding]: TDE is not automatically applied to system databases; it's only for user data files."
        },
        {
          "text": "The <code>master</code> database must be encrypted with TDE to store the DEK for user databases.",
          "misconception": "Targets [key storage confusion]: The `master` database stores the *protector* (certificate/key) for the DEK, not the DEK itself, and TDE isn't directly enabled on `master`."
        },
        {
          "text": "TDE is automatically enabled on <code>tempdb</code> when a user database is encrypted.",
          "misconception": "Targets [specific system DB behavior]: While `tempdb` is encrypted when TDE is enabled on a user database, this is a side effect, not a direct enablement on `tempdb` itself."
        }
      ],
      "detailed_explanation": {
        "core_logic": "TDE is designed to protect user data at rest and is not intended for system databases like <code>master</code>, <code>model</code>, or <code>msdb</code>. These databases contain critical metadata and configuration, and encrypting them directly could complicate recovery. However, <code>tempdb</code> is automatically encrypted when a user database is TDE-enabled to protect temporary data.",
        "distractor_analysis": "Distractors incorrectly claim TDE is automatically applied to all system DBs, misstate the role of <code>master</code> in key storage, or oversimplify <code>tempdb</code>'s encryption.",
        "analogy": "TDE is like a security system for your company's client files (user databases), not for the office building's main security control room (master database) or the general office supplies closet (tempdb)."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "SQL_TDE_ARCHITECTURE",
        "SQL_SYSTEM_DATABASES"
      ]
    },
    {
      "question_text": "What is the impact of enabling TDE on a SQL Server database's performance?",
      "correct_answer": "There is a performance overhead due to the real-time encryption and decryption of data pages.",
      "distractors": [
        {
          "text": "There is no performance impact, as encryption is handled by hardware.",
          "misconception": "Targets [hardware acceleration misconception]: While hardware can assist, TDE still involves CPU overhead for encryption/decryption operations."
        },
        {
          "text": "Performance always improves because encrypted data is more compact.",
          "misconception": "Targets [data compression misconception]: Encryption does not inherently compress data; it adds overhead."
        },
        {
          "text": "Performance improves significantly due to better caching of encrypted pages.",
          "misconception": "Targets [performance benefit misconception]: Encryption adds processing, which generally leads to a performance cost, not a benefit."
        }
      ],
      "detailed_explanation": {
        "core_logic": "TDE performs real-time encryption and decryption of data as it's read from and written to disk. This process consumes CPU resources, leading to a performance overhead. The extent of this overhead depends on factors like CPU speed, TDE algorithm, and whether hardware acceleration is available.",
        "distractor_analysis": "Distractors incorrectly claim no impact, performance improvement due to compression, or improved caching, all of which contradict the known CPU overhead of real-time encryption/decryption.",
        "analogy": "Running TDE is like having a security guard check every item going in and out of a warehouse; it adds a step and takes time, potentially slowing down operations compared to an unsecured warehouse."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "SQL_TDE_PERFORMANCE",
        "CRYPTO_PERFORMANCE_IMPACT"
      ]
    },
    {
      "question_text": "Consider a scenario where a SQL Server database is encrypted with TDE. If the certificate protecting the DEK is lost and no backup exists, what is the consequence?",
      "correct_answer": "The database will become inaccessible, and the data will be unrecoverable.",
      "distractors": [
        {
          "text": "SQL Server will automatically generate a new certificate to decrypt the data.",
          "misconception": "Targets [automatic recovery misconception]: SQL Server cannot regenerate a lost private key or certificate; it requires the original or a backup."
        },
        {
          "text": "The database can be restored from a recent full backup, which will decrypt the data.",
          "misconception": "Targets [backup decryption misconception]: A full backup of a TDE-encrypted database is also encrypted and requires the DEK's protector to be restored."
        },
        {
          "text": "The data can be decrypted using the Service Master Key (SMK).",
          "misconception": "Targets [key hierarchy misunderstanding]: The SMK protects the DEK's protector, but it cannot directly decrypt data encrypted by the DEK if the protector is lost."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The DEK is protected by a TDE protector (certificate/key). If this protector is lost and unrecoverable, the DEK cannot be decrypted, rendering the encrypted database files unreadable. Therefore, the database becomes inaccessible, and data loss is permanent without a backup of the protector.",
        "distractor_analysis": "Distractors propose incorrect recovery methods: automatic regeneration of lost keys, automatic decryption via full backup, or direct decryption by the SMK, none of which are valid when the DEK's protector is irrevocably lost.",
        "analogy": "If you lose the only key to your safe deposit box (DEK protector) and the bank has no record of it, the contents of the box (database data) are permanently inaccessible."
      },
      "code_snippets": [],
      "difficulty": "expert",
      "question_type": "scenario",
      "bloom_level": "apply",
      "prerequisites": [
        "SQL_TDE_RECOVERY",
        "CRYPTO_KEY_LOSS_IMPACT"
      ]
    },
    {
      "question_text": "What is the relationship between TDE and Always Encrypted in SQL Server?",
      "correct_answer": "TDE encrypts data at rest, while Always Encrypted encrypts data in use (in memory) and at rest, protecting it even from database administrators.",
      "distractors": [
        {
          "text": "Always Encrypted is a feature that replaces TDE for enhanced security.",
          "misconception": "Targets [unknown]: Not specified"
        },
        {
          "text": "TDE encrypts data in transit, while Always Encrypted encrypts data at rest.",
          "misconception": "Targets [functional role reversal]: TDE is for data at rest; Always Encrypted is for data in use and at rest."
        },
        {
          "text": "Both TDE and Always Encrypted use the same encryption keys.",
          "misconception": "Targets [key management confusion]: They typically use different key management strategies and keys."
        }
      ],
      "detailed_explanation": {
        "core_logic": "TDE protects data stored on disk (at rest) by encrypting database files. Always Encrypted protects data while it's being processed in memory and also at rest, by encrypting specific columns and keeping the keys outside the database, even from DBAs. They are complementary security features.",
        "distractor_analysis": "Distractors incorrectly suggest Always Encrypted replaces TDE, reverse their primary functions, or claim they share keys, misunderstanding their distinct roles and key management.",
        "analogy": "TDE is like locking your entire house (database files) when you're away. Always Encrypted is like putting your most valuable documents (specific data columns) in a separate, highly secure vault within your house, accessible only by you, even if someone gets into the house."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "comparison",
      "bloom_level": "analyze",
      "prerequisites": [
        "SQL_TDE_ARCHITECTURE",
        "SQL_ALWAYS_ENCRYPTED"
      ]
    },
    {
      "question_text": "In Azure SQL Database, how is TDE typically managed for a server and its databases?",
      "correct_answer": "TDE is configured at the server level using a TDE protector (certificate or customer-managed key), which is then inherited by all databases on that server.",
      "distractors": [
        {
          "text": "TDE must be enabled individually for each database.",
          "misconception": "Targets [scope error]: TDE is managed at the server level for Azure SQL Database, not per database by default."
        },
        {
          "text": "TDE is managed through a separate service that encrypts database backups only.",
          "misconception": "Targets [functional scope error]: TDE encrypts live database files, logs, and backups, not just backups, and is integrated with the server."
        },
        {
          "text": "TDE is automatically enabled and managed by Microsoft with no customer configuration required.",
          "misconception": "Targets [service-managed vs. customer-managed confusion]: While service-managed TDE exists, customer-managed keys offer more control and require configuration."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Azure SQL Database simplifies TDE management by allowing configuration at the server level. A single TDE protector (either a service-managed certificate or a customer-managed key) is applied to the server and automatically protects all databases hosted on it, ensuring consistent encryption at rest.",
        "distractor_analysis": "Distractors incorrectly suggest per-database configuration, limited scope to backups, or complete lack of customer involvement, missing the server-level management and the option for customer-managed keys.",
        "analogy": "In Azure SQL, TDE is like setting a master key for a whole building (server) that automatically locks all the individual apartments (databases) within it, rather than having to lock each apartment door separately."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "AZURE_SQL_TDE",
        "CLOUD_ENCRYPTION_MANAGEMENT"
      ]
    },
    {
      "question_text": "What is the purpose of the Service Master Key (SMK) in SQL Server's encryption hierarchy?",
      "correct_answer": "It is the root key that encrypts other master keys, such as the Database Master Key (DMK), and sensitive credentials.",
      "distractors": [
        {
          "text": "It directly encrypts all user data within TDE-enabled databases.",
          "misconception": "Targets [root key vs. data key confusion]: The SMK is at the top of the hierarchy but doesn't directly encrypt user data; the DEK does."
        },
        {
          "text": "It is used to encrypt communication channels between SQL Server instances.",
          "misconception": "Targets [encryption purpose confusion]: SMK is for encrypting keys and credentials stored within SQL Server, not for network communication."
        },
        {
          "text": "It is generated by the user and used to encrypt the TDE certificate.",
          "misconception": "Targets [key generation and purpose confusion]: The SMK is automatically generated by SQL Server and protects other keys, not the TDE certificate directly."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The SMK serves as the root of SQL Server's encryption hierarchy. It is automatically generated upon instance startup and is used to encrypt critical elements like the Database Master Key (DMK) and linked server passwords. This hierarchical approach ensures that the SMK's security is paramount for protecting all other encrypted secrets.",
        "distractor_analysis": "Distractors misrepresent the SMK's role by suggesting it directly encrypts user data, encrypts network traffic, or is user-generated for TDE certificates, all of which are incorrect.",
        "analogy": "The SMK is like the master key to a secure facility that unlocks smaller key cabinets (DMK, credentials), which in turn hold keys to individual rooms (database data)."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "SQL_KEY_HIERARCHY",
        "CRYPTO_KEY_MANAGEMENT"
      ]
    },
    {
      "question_text": "When moving a TDE-protected database to another SQL Server instance, what is a critical requirement for the target instance?",
      "correct_answer": "The target instance must have access to the certificate or asymmetric key that protects the DEK.",
      "distractors": [
        {
          "text": "The target instance must have the same version of SQL Server installed.",
          "misconception": "Targets [version dependency misconception]: While version compatibility is important, access to the encryption key is the direct requirement for TDE decryption."
        },
        {
          "text": "The target instance must have TDE enabled by default.",
          "misconception": "Targets [default setting misconception]: TDE needs to be enabled, but the key access is the prerequisite for decrypting the existing data."
        },
        {
          "text": "The target instance must be able to automatically generate a new DEK.",
          "misconception": "Targets [key regeneration misconception]: The target instance needs to decrypt the existing DEK, not generate a new one, to access the data."
        }
      ],
      "detailed_explanation": {
        "core_logic": "For a TDE-protected database to be accessible on a new SQL Server instance, that instance must possess the TDE protector (certificate or asymmetric key) that was used to encrypt the DEK. Without this protector, the DEK cannot be decrypted, and thus the database files remain unreadable.",
        "distractor_analysis": "Distractors suggest irrelevant requirements like matching SQL Server versions, default TDE enablement, or automatic DEK generation, overlooking the fundamental need for the DEK's protector.",
        "analogy": "Moving a locked suitcase (TDE database) to a new location requires bringing the specific key to that suitcase's lock (DEK protector), not just any key or a new lock."
      },
      "code_snippets": [],
      "difficulty": "expert",
      "question_type": "scenario",
      "bloom_level": "apply",
      "prerequisites": [
        "SQL_TDE_MIGRATION",
        "CRYPTO_KEY_ACCESS"
      ]
    },
    {
      "question_text": "What is the primary security benefit of using TDE with Azure Key Vault or Azure Managed HSM?",
      "correct_answer": "It allows for separation of duties between data management and key management, and keys are stored securely outside the database.",
      "distractors": [
        {
          "text": "It automatically encrypts all data in transit between Azure services.",
          "misconception": "Targets [scope confusion]: TDE is for data at rest; network encryption is handled by other Azure services."
        },
        {
          "text": "It eliminates the need for regular database backups.",
          "misconception": "Targets [misunderstanding of backup necessity]: TDE protects data at rest but does not replace the need for backups for disaster recovery and point-in-time restores."
        },
        {
          "text": "It guarantees that Microsoft cannot access the encrypted data.",
          "misconception": "Targets [absolute security misconception]: While key control is with the customer, Microsoft's infrastructure manages the services; 'guarantee' is too strong."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Using Azure Key Vault or Managed HSM for TDE protectors provides enhanced security by allowing customers to manage their encryption keys independently from the database. This separation of duties is a key security best practice, and the keys are stored in a highly secure, dedicated HSM environment, reducing the risk of compromise.",
        "distractor_analysis": "Distractors incorrectly associate TDE with data-in-transit encryption, suggest it negates the need for backups, or overstate the absolute security guarantee, missing the core benefits of key management separation and secure key storage.",
        "analogy": "Using Azure Key Vault with TDE is like having your house keys (TDE protector) stored in a bank vault (Key Vault) while your house (database) is secured by a lock that uses those keys. This separates the security of your house from the security of your keys."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "defense",
      "bloom_level": "analyze",
      "prerequisites": [
        "AZURE_SQL_TDE",
        "CLOUD_KEY_MANAGEMENT",
        "SEPARATION_OF_DUTIES"
      ]
    },
    {
      "question_text": "What happens to TDE-encrypted database backups when the TDE protector is rotated (e.g., a new certificate is used)?",
      "correct_answer": "Older backups remain encrypted with the original TDE protector and require that protector for restoration.",
      "distractors": [
        {
          "text": "All previous backups are automatically re-encrypted with the new TDE protector.",
          "misconception": "Targets [backup immutability misconception]: Backups are immutable snapshots; they are not retroactively updated with new encryption keys."
        },
        {
          "text": "The new TDE protector can decrypt all previous backups.",
          "misconception": "Targets [key compatibility misconception]: A new protector is for new encryption; it cannot decrypt data encrypted by a different, older protector."
        },
        {
          "text": "Backups become unencrypted after the TDE protector is rotated.",
          "misconception": "Targets [encryption state misconception]: Backups retain their original encryption status; rotation affects only future encryption."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Database backups, once created, are immutable. If a database is encrypted with TDE, its backups are also encrypted using the DEK, which is protected by the current TDE protector. When the TDE protector is rotated, only new data and new backups will use the new protector. Older backups will still require the original protector for restoration.",
        "distractor_analysis": "Distractors incorrectly assume automatic re-encryption of old backups, compatibility of new protectors with old data, or that backups become unencrypted, all of which contradict how encryption and backups function.",
        "analogy": "If you change the lock on your house (rotate TDE protector), your old house keys (old backups) still only work with the old lock, not the new one. You need the old key to access things locked with the old lock."
      },
      "code_snippets": [],
      "difficulty": "expert",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "SQL_TDE_BACKUPS",
        "CRYPTO_KEY_ROTATION_IMPACT"
      ]
    },
    {
      "question_text": "Which of the following is a limitation of TDE in SQL Server regarding specific data types or features?",
      "correct_answer": "FILESTREAM data is not encrypted by TDE, even when TDE is enabled for the database.",
      "distractors": [
        {
          "text": "TDE does not encrypt data stored in memory-optimized tables.",
          "misconception": "Targets [feature compatibility misconception]: TDE does encrypt In-Memory OLTP log records and data in recent SQL Server versions."
        },
        {
          "text": "TDE cannot encrypt data stored in <code>tempdb</code>.",
          "misconception": "Targets [system database scope]: `tempdb` is automatically encrypted when a user database is TDE-enabled."
        },
        {
          "text": "TDE encrypts all data, including full-text indexes.",
          "misconception": "Targets [index encryption misconception]: While full-text indexes are encrypted when TDE is enabled, this statement implies TDE encrypts *all* data types without exception."
        }
      ],
      "detailed_explanation": {
        "core_logic": "TDE encrypts data and log files at rest. However, it has limitations, notably that FILESTREAM data, which is stored outside the database files in the file system, is not encrypted by TDE. While In-Memory OLTP data and full-text indexes are generally encrypted, FILESTREAM is a known exception.",
        "distractor_analysis": "Distractors incorrectly claim TDE doesn't encrypt In-Memory OLTP, <code>tempdb</code>, or full-text indexes, whereas FILESTREAM is the primary feature explicitly stated as not being encrypted by TDE.",
        "analogy": "TDE is like a secure vault for your main filing cabinets (database files), but it doesn't secure items stored in a separate, unsecured storage locker (FILESTREAM data)."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "SQL_TDE_LIMITATIONS",
        "SQL_FILESTREAM"
      ]
    },
    {
      "question_text": "What is the role of the <code>master</code> database in SQL Server TDE when using a certificate to protect the DEK?",
      "correct_answer": "It stores the certificate and its private key, which are used to decrypt the DEK.",
      "distractors": [
        {
          "text": "It directly encrypts the database data files using the certificate.",
          "misconception": "Targets [unknown]: Not specified"
        },
        {
          "text": "It holds the Database Encryption Key (DEK) itself.",
          "misconception": "Targets [key storage location misconception]: The DEK is stored within the user database; the `master` database stores the key that protects the DEK."
        },
        {
          "text": "It automatically generates new TDE certificates when the old ones expire.",
          "misconception": "Targets [key management automation misconception]: Certificate management, including renewal and backup, is a manual or externally managed process."
        }
      ],
      "detailed_explanation": {
        "core_logic": "When TDE uses a certificate to protect the DEK, that certificate (and its private key) is stored in the <code>master</code> database. This allows SQL Server to access the certificate to decrypt the DEK when the database is started or accessed, thereby enabling decryption of the database files.",
        "distractor_analysis": "Distractors incorrectly place direct encryption, the DEK itself, or automatic certificate generation within the <code>master</code> database, misrepresenting its role in TDE key management.",
        "analogy": "The <code>master</code> database acts as a secure vault for the key (certificate) that unlocks the box containing the keys to your data files (DEK)."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "SQL_TDE_ARCHITECTURE",
        "SQL_CERTIFICATES"
      ]
    },
    {
      "question_text": "In the context of SQL Server TDE, what does 'data at rest' refer to?",
      "correct_answer": "Data stored in database files on disk, including data files, log files, and backups.",
      "distractors": [
        {
          "text": "Data being transmitted over the network between the client and the server.",
          "misconception": "Targets [data state confusion]: 'Data at rest' is distinct from 'data in transit'."
        },
        {
          "text": "Data currently held in memory (RAM) by the SQL Server process.",
          "misconception": "Targets [data state confusion]: Data in memory is 'data in use', not 'data at rest'."
        },
        {
          "text": "Data that has been temporarily stored in the <code>tempdb</code> database.",
          "misconception": "Targets [temporary storage misconception]: While `tempdb` data is at rest when on disk, TDE's primary focus is persistent database files, and `tempdb` is a specific case."
        }
      ],
      "detailed_explanation": {
        "core_logic": "'Data at rest' refers to any data that is persistently stored on physical storage media, such as hard drives or SSDs. For SQL Server, this includes the primary data files (.mdf, .ndf), transaction log files (.ldf), and any database backup files (.bak, .trn). TDE's purpose is to protect this stored data.",
        "distractor_analysis": "Distractors incorrectly define 'data at rest' as data in transit, data in memory, or specifically <code>tempdb</code> data, missing the broader definition of persistent storage.",
        "analogy": "'Data at rest' is like documents stored in a locked filing cabinet in an office, whereas 'data in transit' is like documents being mailed between offices, and 'data in use' is like documents spread out on a desk for active work."
      },
      "code_snippets": [],
      "difficulty": "foundational",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "DATA_SECURITY_FUNDAMENTALS",
        "CRYPTO_TERMINOLOGY"
      ]
    },
    {
      "question_text": "What is the primary function of the Database Master Key (DMK) in SQL Server's encryption hierarchy?",
      "correct_answer": "To protect the private keys of certificates and asymmetric keys that are used for other encryption operations.",
      "distractors": [
        {
          "text": "To directly encrypt all sensitive data within user databases.",
          "misconception": "Targets [key hierarchy confusion]: DMK protects other keys; DEK or column-level encryption directly encrypts data."
        },
        {
          "text": "To encrypt the Service Master Key (SMK) when it is backed up.",
          "misconception": "Targets [hierarchy reversal]: The SMK encrypts the DMK, not the other way around."
        },
        {
          "text": "To provide a symmetric key for encrypting database connections.",
          "misconception": "Targets [key type and purpose confusion]: DMK is primarily for protecting other keys, not for direct connection encryption."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The DMK is a symmetric key that acts as a central point for protecting other cryptographic assets within a database, specifically the private keys of certificates and asymmetric keys. By encrypting these keys, the DMK ensures that they can only be accessed and used when the DMK itself is opened, typically by the SMK or a password.",
        "distractor_analysis": "Distractors incorrectly assign the DMK the role of directly encrypting user data, encrypting the SMK, or acting as a connection encryption key, misrepresenting its function in the key management hierarchy.",
        "analogy": "The DMK is like a secure box that holds the keys to your most valuable tools (certificates/asymmetric keys), which are then used for specific tasks like building (data encryption)."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "definition",
      "bloom_level": "analyze",
      "prerequisites": [
        "SQL_KEY_HIERARCHY",
        "CRYPTO_KEY_MANAGEMENT"
      ]
    }
  ],
  "generation_metadata": {
    "model": "google/gemini-2.5-flash-lite",
    "num_generated": 18,
    "temperature": 0.1,
    "web_citations": [],
    "research_method": "openrouter_web_plugin",
    "search_query": "SQL Server Transparent Data Encryption Security Architecture And Engineering best practices",
    "latency_ms": 29533.199
  },
  "timestamp": "2026-01-01T14:08:16.578466"
}