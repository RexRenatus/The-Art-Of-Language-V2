version: '2.0'
metadata:
  topic_title: IPSec Tunnel Mode
  hierarchy:
    level_1_category: Cybersecurity
    level_2_domain: Security Architecture And Engineering
    level_3_subdomain: Cryptographic Solutions
    level_4_entry_domain: Cryptographic Protocols
    level_5_entry_subdomain: Internet Protocol Security (IPSec)
    level_6_topic: IPSec Tunnel Mode
  curriculum_type: cybersecurity
  source_folders:
    category: 001_cybersecurity
    domain: 002_security-architecture-and-engineering
    subdomain: 003_cryptographic-solutions
  exa_sources: []
  voting:
    consensus_reached: true
    approval_percentage: 1.0
    total_voters: 7
  generation_timestamp: '2026-01-01T14:11:05.396969'
learning_objectives:
  remember:
  - objective: Define key terminology
    verbs:
    - define
    measurable: true
  understand:
  - objective: Explain core concepts
    verbs:
    - explain
    measurable: true
  analyze:
  - objective: Analyze relationships
    verbs:
    - analyze
    measurable: true
  apply:
  - objective: Apply knowledge to scenarios
    verbs:
    - apply
    measurable: true
active_learning:
  discussion_prompt: Compare IPSec Tunnel Mode with Transport Mode. In what scenarios would a company prefer Tunnel Mode for
    site-to-site VPNs (e.g., branch offices over the internet), and what are the trade-offs in terms of overhead, security,
    and performance? Debate real-world pros/cons like ESP's prevalence over AH.
  peer_teaching: 'Pair students: One explains the step-by-step encapsulation process in Tunnel Mode using a hand-drawn diagram
    (original IP packet → ESP/AH → new outer IP header), highlighting ESP''s confidentiality/integrity features. The partner
    teaches back the decapsulation process. Switch roles and discuss misconceptions, such as confusing inner/outer headers
    or ESP vs. AH capabilities.'
  problem_solving: 'Scenario: A remote office connects to HQ via VPN over the internet. Design an IPSec Tunnel Mode setup
    specifying ESP (for confidentiality/integrity/auth/anti-replay), AH if needed, IKEv2 key management, and troubleshoot
    an MTU issue causing fragmentation (e.g., adjust MSS clamping to 1400 bytes).'
  additional_activities: []
scaffolding:
- level: 1
  name: Foundation
  focus: Basic terminology and definitions
  content: ''
- level: 2
  name: Components
  focus: Framework components and structure
  content: ''
- level: 3
  name: Implementation
  focus: Practical implementation steps
  content: ''
- level: 4
  name: Integration
  focus: Advanced integration and optimization
  content: ''
flashcard_generation:
  output_schema:
    question: string
    correct_answer: string
    distractors:
    - text: string
      explanation: string
    explanation: string
    bloom_level: enum
    topic_hierarchy: object
  distractor_protocol: 'Create 3 plausible distractors per MCQ based on common misconceptions: 1) Confuse Tunnel/Transport
    modes (e.g., ''protects only payload''), 2) Misattribute ESP/AH features (e.g., ''AH provides encryption''), 3) Overhead/NAT
    issues (e.g., ''no MTU impact''), 4) Protocol details (e.g., ''ESP lacks anti-replay''). Ensure distractors are 70% correct-sounding
    but factually wrong.'
system_prompt: 'You are an expert flashcard generator for cybersecurity education, specializing in IPSec Tunnel Mode (Topic
  Hierarchy: Cybersecurity > Security Architecture And Engineering > Cryptographic Solutions > Cryptographic Protocols > IPSec
  > IPSec Tunnel Mode). Use the provided scaffolding (4 layers), learning objectives (spanning Bloom''s: REMEMBER to CREATE),
  active learning activities, and research context to generate high-quality, pedagogically optimized flashcards.


  Key Facts to Incorporate:

  - IPSec Tunnel Mode encapsulates entire original IP packet in new IP packet for VPNs.

  - ESP: Confidentiality (encryption), integrity/auth (ICV), anti-replay; common over AH (integrity/auth/anti-replay only,
  no confidentiality).

  - Steps: Outer IP > ESP/AH Header > Encrypted Original IP + Payload + Trailer/ICV.

  - Vs Transport: Tunnel for site-to-site, higher overhead.

  - Sources: RFC 4301/4303/4302/7296.


  Output ONLY in JSON: {''flashcards'': [array of objects]}, each object: {''type'': ''Q&A|MCQ|scenario'', ''layer'': ''1-4'',
  ''blooms_level'': ''REMEMBER|etc'', ''front'': ''question text/diagram desc'', ''back'': {''answer'': ''...'', ''explanation'':
  ''...'', ''distractors_explained'': ''[if MCQ]'', ''active_link'': ''discussion/peer/problem ref''}}.


  Generate 10-15 cards per scaffolding layer, balanced by Bloom''s (2 remember/understand, 3 apply/analyze, 2 evaluate/create
  per layer). Ensure active learning integration (e.g., cards prompting diagram for peer teaching). Use distractor protocol
  strictly. Make engaging, accurate, university-level.'
