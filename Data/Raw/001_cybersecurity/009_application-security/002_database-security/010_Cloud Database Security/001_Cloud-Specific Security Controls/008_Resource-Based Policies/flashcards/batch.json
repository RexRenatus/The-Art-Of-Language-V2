{
  "topic_title": "Resource-Based Policies",
  "category": "008_Application Security - 012_Database Security",
  "flashcards": [
    {
      "question_text": "What is the primary function of resource-based policies in AWS services like DynamoDB?",
      "correct_answer": "To define permissions for access to a specific resource, allowing principals (users, roles) to perform actions on it.",
      "distractors": [
        {
          "text": "To define permissions for IAM users and roles, specifying what actions they can perform across all AWS services.",
          "misconception": "Targets [scope confusion]: Confuses identity-based policies with resource-based policies."
        },
        {
          "text": "To enforce network access control lists (ACLs) for VPC endpoints and subnets.",
          "misconception": "Targets [domain confusion]: Mixes database resource policies with network security controls."
        },
        {
          "text": "To manage encryption keys and control access to sensitive data stored in KMS.",
          "misconception": "Targets [service confusion]: Associates resource policies with KMS key management instead of resource access."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Resource-based policies are attached directly to AWS resources, like DynamoDB tables, to specify which principals can access them and what actions they can perform. This works by defining explicit permissions at the resource level, complementing identity-based policies.",
        "distractor_analysis": "The first distractor describes identity-based policies. The second conflates resource policies with network ACLs. The third incorrectly links them to KMS key management.",
        "analogy": "Think of a resource-based policy like a sign on a specific room's door saying 'Only authorized personnel allowed,' while an identity-based policy is like an employee ID badge that grants access to many rooms."
      },
      "code_snippets": [],
      "difficulty": "foundational",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "IAM_BASICS",
        "AWS_SERVICES"
      ]
    },
    {
      "question_text": "According to AWS best practices, when should resource-based policies be used for DynamoDB tables and streams?",
      "correct_answer": "For all DynamoDB tables and streams to enforce access control centrally at the resource level.",
      "distractors": [
        {
          "text": "Only when cross-account access is required to the DynamoDB resources.",
          "misconception": "Targets [scope limitation]: Assumes resource policies are only for external access, not internal."
        },
        {
          "text": "When identity-based policies become too complex to manage for individual users.",
          "misconception": "Targets [misapplication]: Suggests resource policies are a simplification tool rather than a primary control mechanism."
        },
        {
          "text": "Primarily for read-only access to prevent accidental data modification.",
          "misconception": "Targets [granularity error]: Limits the use case to specific permission types, ignoring broader access control."
        }
      ],
      "detailed_explanation": {
        "core_logic": "AWS recommends using resource-based policies for all DynamoDB tables and streams to centralize permissions and simplify access control. This approach reduces administration overhead and enhances security by defining access directly on the resource.",
        "distractor_analysis": "The first distractor incorrectly limits their use to cross-account scenarios. The second suggests they are solely for managing complexity, not as a core control. The third restricts their application to read-only scenarios.",
        "analogy": "It's like having a security guard at the entrance of every important building (DynamoDB resource) rather than just relying on individual employee badges (identity-based policies) for all access."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "procedure",
      "bloom_level": "apply",
      "prerequisites": [
        "DDB_SECURITY",
        "AWS_IAM_POLICIES"
      ]
    },
    {
      "question_text": "What is the principle of 'least privilege' as applied to resource-based policies?",
      "correct_answer": "Granting only the specific permissions required to perform an action on a resource, under defined conditions.",
      "distractors": [
        {
          "text": "Granting broad administrative access to all resources within an account.",
          "misconception": "Targets [anti-pattern]: Describes the opposite of least privilege, a common security anti-pattern."
        },
        {
          "text": "Allowing access to all resources but restricting the types of actions allowed.",
          "misconception": "Targets [scope confusion]: Mixes resource scope with action limitations, not focusing on minimum necessary permissions."
        },
        {
          "text": "Providing full access to a resource for a limited duration.",
          "misconception": "Targets [temporary access confusion]: Confuses least privilege with time-bound access, which can still be overly permissive."
        }
      ],
      "detailed_explanation": {
        "core_logic": "The principle of least privilege dictates that identities should only have the minimum permissions necessary to perform their tasks. When using resource-based policies, this means defining actions on specific resources under precise conditions, thereby minimizing potential exposure.",
        "distractor_analysis": "The first distractor represents an anti-pattern. The second confuses resource scope with action scope. The third misinterprets least privilege as solely time-limited access.",
        "analogy": "It's like giving a temporary key that only opens the specific room you need for a task, rather than a master key that opens every door in the building."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "IAM_BASICS",
        "SECURITY_PRINCIPLES"
      ]
    },
    {
      "question_text": "How do resource-based policies simplify access control within the same AWS account?",
      "correct_answer": "By allowing a single resource-based policy on the resource to grant access to multiple principals, eliminating the need for individual identity-based policies for each principal.",
      "distractors": [
        {
          "text": "By automatically creating identity-based policies for all users who access the resource.",
          "misconception": "Targets [automation confusion]: Incorrectly assumes resource policies automate identity policy creation."
        },
        {
          "text": "By consolidating all identity-based policies into a single, manageable policy document.",
          "misconception": "Targets [consolidation confusion]: Mixes the concept of resource policies with consolidating identity policies."
        },
        {
          "text": "By enabling principals to define their own access permissions to resources.",
          "misconception": "Targets [permission model confusion]: Reverses the control model; policies are defined by resource owners, not consumers."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Resource-based policies simplify access control within the same account by centralizing permissions on the resource itself. This means a single policy attached to the resource can grant access to multiple IAM principals, reducing the overhead of managing numerous identity-based policies.",
        "distractor_analysis": "The first distractor wrongly suggests automatic identity policy generation. The second incorrectly implies consolidation of identity policies. The third reverses the control flow, suggesting principals define their own access.",
        "analogy": "Instead of giving each visitor a unique key to your house (identity-based), you put a sign on the door saying 'Family and friends welcome' (resource-based), simplifying entry for known groups."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "IAM_POLICIES",
        "AWS_ACCOUNT_STRUCTURE"
      ]
    },
    {
      "question_text": "What happens if no resource-based policy is specified for an AWS resource, and no identity-based policies allow access?",
      "correct_answer": "Access to the resource will be implicitly denied.",
      "distractors": [
        {
          "text": "Access will be implicitly granted to all authenticated users.",
          "misconception": "Targets [default behavior confusion]: Assumes a permissive default instead of a restrictive one."
        },
        {
          "text": "Access will be granted only to the AWS account root user.",
          "misconception": "Targets [root user privilege confusion]: Overstates the root user's implicit access without explicit policy."
        },
        {
          "text": "The resource will become publicly accessible until a policy is defined.",
          "misconception": "Targets [public access confusion]: Incorrectly assumes resources default to public accessibility."
        }
      ],
      "detailed_explanation": {
        "core_logic": "In AWS, the default security posture is deny-all. Therefore, if no resource-based policy is attached to a resource and no identity-based policies permit access, the request is implicitly denied. This principle ensures that access is only granted when explicitly allowed.",
        "distractor_analysis": "The first distractor suggests a permissive default. The second incorrectly grants implicit access to the root user. The third wrongly assumes public accessibility.",
        "analogy": "It's like a secure building where doors are locked by default. If there's no key card access (identity policy) and no specific permission slip for that room (resource policy), you can't get in."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "IAM_POLICIES",
        "AWS_SECURITY_MODEL"
      ]
    },
    {
      "question_text": "Which AWS service can help analyze cross-account access activity to refine resource-based policies for least privilege?",
      "correct_answer": "IAM Access Analyzer",
      "distractors": [
        {
          "text": "CloudTrail",
          "misconception": "Targets [tool confusion]: CloudTrail logs actions but doesn't directly analyze cross-account policy effectiveness for refinement."
        },
        {
          "text": "AWS Config",
          "misconception": "Targets [tool confusion]: AWS Config tracks resource configurations but not cross-account access analysis for policy generation."
        },
        {
          "text": "Security Hub",
          "misconception": "Targets [tool confusion]: Security Hub aggregates security findings but doesn't specifically generate least-privilege policies from access logs."
        }
      ],
      "detailed_explanation": {
        "core_logic": "IAM Access Analyzer is designed to analyze resource-based policies and identify external or cross-account access. It provides visibility into who has access to your resources, helping you refine permissions to adhere to the principle of least privilege by generating policy suggestions.",
        "distractor_analysis": "CloudTrail logs actions, AWS Config tracks configurations, and Security Hub aggregates findings, but IAM Access Analyzer is the specific tool for analyzing resource-based policies for cross-account access and generating least-privilege policies.",
        "analogy": "IAM Access Analyzer is like a security auditor who reviews your building's access logs and visitor list to ensure only necessary people have keys to specific areas."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "IAM_ACCESS_ANALYZER",
        "LEAST_PRIVILEGE"
      ]
    },
    {
      "question_text": "Resource-based policies are typically inline only. What does this mean for their management?",
      "correct_answer": "They cannot be created as separate, reusable managed policies; they must be defined directly within the resource's configuration.",
      "distractors": [
        {
          "text": "They can be created as managed policies and attached to multiple resources.",
          "misconception": "Targets [policy type confusion]: Confuses resource-based policies with identity-based managed policies."
        },
        {
          "text": "They are automatically generated and managed by AWS based on resource usage.",
          "misconception": "Targets [management model confusion]: Assumes AWS automatically manages these policies, which is incorrect."
        },
        {
          "text": "They are only applicable to resources within a single AWS account.",
          "misconception": "Targets [scope limitation]: Incorrectly limits their applicability based on management type rather than policy definition."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Unlike identity-based policies, resource-based policies are inline only, meaning they are embedded directly within the resource's configuration (e.g., a DynamoDB table's policy). This contrasts with managed policies, which can be created independently and attached to multiple identities. Therefore, they are not reusable across different resources.",
        "distractor_analysis": "The first distractor incorrectly states they can be managed policies. The second wrongly suggests automatic AWS management. The third incorrectly limits their scope based on management type.",
        "analogy": "It's like writing a specific instruction note directly on a piece of equipment (inline resource policy) versus having a general instruction manual that applies to many pieces of equipment (managed identity policy)."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "definition",
      "bloom_level": "understand",
      "prerequisites": [
        "IAM_POLICY_TYPES",
        "AWS_RESOURCE_MANAGEMENT"
      ]
    },
    {
      "question_text": "Consider a scenario where an IAM user needs to access a DynamoDB table. Which policy type is MOST appropriate for defining permissions directly on the table itself?",
      "correct_answer": "Resource-based policy",
      "distractors": [
        {
          "text": "Identity-based policy",
          "misconception": "Targets [policy type confusion]: This policy is attached to the user, not the resource, and defines user permissions generally."
        },
        {
          "text": "Permissions boundary",
          "misconception": "Targets [policy type confusion]: This sets maximum permissions for an identity, not direct resource access control."
        },
        {
          "text": "Service control policy (SCP)",
          "misconception": "Targets [scope confusion]: SCPs are for AWS Organizations to set guardrails across accounts, not specific resource access."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Resource-based policies are specifically designed to grant access to a resource by being attached directly to that resource. Therefore, for defining permissions on the DynamoDB table itself, a resource-based policy is the most appropriate choice, complementing any identity-based policies the user might have.",
        "distractor_analysis": "Identity-based policies control user permissions, permissions boundaries limit maximum permissions, and SCPs control guardrails at the organization level, none of which directly define access on the resource itself like a resource-based policy does.",
        "analogy": "If the table is a specific book, the resource-based policy is like a bookmark inside the book stating who can read it, while an identity-based policy is like the library card that allows you to borrow books."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "scenario",
      "bloom_level": "apply",
      "prerequisites": [
        "IAM_POLICY_TYPES",
        "DDB_SECURITY"
      ]
    },
    {
      "question_text": "What is a key benefit of using resource-based policies for controlling access to AWS resources like DynamoDB?",
      "correct_answer": "Centralized permissions management at the resource level, reducing administrative overhead.",
      "distractors": [
        {
          "text": "Enabling fine-grained control over individual IAM user actions across all services.",
          "misconception": "Targets [scope confusion]: This describes identity-based policies, not resource-based policies."
        },
        {
          "text": "Providing a global default access level for all resources within an AWS account.",
          "misconception": "Targets [default behavior confusion]: Resource policies are specific, not global defaults, and are typically restrictive."
        },
        {
          "text": "Automating the creation and rotation of access keys for principals.",
          "misconception": "Targets [function confusion]: This relates to access key management, not policy definition."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Resource-based policies offer a significant benefit by centralizing access control directly on the resource. This simplifies administration because permissions are defined where the resource resides, rather than being distributed across numerous identity-based policies for each principal that needs access.",
        "distractor_analysis": "The first distractor describes identity-based policies. The second incorrectly suggests a global default. The third relates to access key management, not policy definition.",
        "analogy": "It's like having a security guard posted at the entrance of a specific building (resource) to control who enters, rather than relying on each person's individual security clearance (identity policy) for every building they might visit."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "IAM_POLICIES",
        "AWS_RESOURCE_MANAGEMENT"
      ]
    },
    {
      "question_text": "When evaluating policy evaluation logic within a single AWS account, how do identity-based and resource-based policies interact?",
      "correct_answer": "AWS evaluates both identity-based and resource-based policies. If any policy explicitly denies access, the request is denied. If any policy explicitly allows access and no policy denies it, the request is allowed.",
      "distractors": [
        {
          "text": "Identity-based policies always take precedence over resource-based policies.",
          "misconception": "Targets [precedence confusion]: Assumes a strict hierarchy, whereas AWS uses an explicit allow/deny logic."
        },
        {
          "text": "Resource-based policies are only evaluated if identity-based policies explicitly deny access.",
          "misconception": "Targets [evaluation order confusion]: Incorrectly sequences the evaluation process."
        },
        {
          "text": "Only the policy type that explicitly grants permission is evaluated.",
          "misconception": "Targets [evaluation logic confusion]: Ignores the explicit deny logic and the need to check all applicable policies."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Within a single account, AWS evaluates all applicable policies (identity-based and resource-based). The final decision is based on explicit denies taking precedence. If no explicit deny exists, an explicit allow from any applicable policy grants access. This 'explicit deny overrides explicit allow' logic ensures security.",
        "distractor_analysis": "The first distractor incorrectly assigns precedence. The second misrepresents the evaluation order. The third ignores the explicit deny rule and the comprehensive evaluation process.",
        "analogy": "Imagine a club with two sets of rules: one from the member's club card (identity policy) and one posted on the club door (resource policy). If either rule says 'No entry' (explicit deny), you're out. If both say 'Entry allowed' (explicit allow), you're in."
      },
      "code_snippets": [],
      "difficulty": "expert",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "IAM_POLICY_EVALUATION",
        "AWS_SECURITY_MODEL"
      ]
    },
    {
      "question_text": "Which of the following is a common anti-pattern when implementing resource-based policies?",
      "correct_answer": "Creating overly permissive policies without proper scoping, leading to permissions creep.",
      "distractors": [
        {
          "text": "Attaching resource-based policies to IAM users instead of resources.",
          "misconception": "Targets [misapplication]: Describes incorrect attachment of policy types, not a common issue with resource policies themselves."
        },
        {
          "text": "Relying solely on identity-based policies and ignoring resource-level controls.",
          "misconception": "Targets [omission]: This is an anti-pattern of *not* using resource policies, rather than an anti-pattern *of* using them."
        },
        {
          "text": "Using resource-based policies only for read-only access.",
          "misconception": "Targets [limitation]: Restricting their use unnecessarily is a suboptimal practice, but 'overly permissive' is a more direct anti-pattern."
        }
      ],
      "detailed_explanation": {
        "core_logic": "A common anti-pattern is creating resource-based policies that are too broad, granting more permissions than necessary. This 'permissions creep' increases the attack surface. Proper scoping, adhering to the principle of least privilege, is crucial for effective resource-based policy management.",
        "distractor_analysis": "The first distractor describes a fundamental misunderstanding of where resource policies are attached. The second is an anti-pattern of omission. The third is a limitation, not as severe an anti-pattern as overly permissive policies.",
        "analogy": "It's like giving every visitor a master key to your entire house (overly permissive) instead of just the key to the specific room they need to access."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "defense",
      "bloom_level": "evaluate",
      "prerequisites": [
        "LEAST_PRIVILEGE",
        "IAM_POLICY_BEST_PRACTICES"
      ]
    },
    {
      "question_text": "How can IAM Access Analyzer assist in refining resource-based policies for DynamoDB tables?",
      "correct_answer": "By analyzing existing resource-based policies to identify unintended cross-account or public access, suggesting modifications for least privilege.",
      "distractors": [
        {
          "text": "By automatically rewriting resource-based policies to enforce encryption at rest.",
          "misconception": "Targets [scope confusion]: IAM Access Analyzer focuses on access permissions, not encryption configurations."
        },
        {
          "text": "By logging all access attempts to DynamoDB tables for auditing purposes.",
          "misconception": "Targets [tool confusion]: CloudTrail logs access; Access Analyzer analyzes policies for access grants."
        },
        {
          "text": "By enforcing network segmentation rules between DynamoDB and other AWS services.",
          "misconception": "Targets [domain confusion]: Access Analyzer deals with IAM policies, not network configurations."
        }
      ],
      "detailed_explanation": {
        "core_logic": "IAM Access Analyzer examines resource-based policies to detect unintended access grants, particularly cross-account or public access. It helps security teams identify resources that might be overly exposed and provides recommendations to adjust the policies, thereby enforcing least privilege principles for services like DynamoDB.",
        "distractor_analysis": "The first distractor misattributes encryption management. The second confuses its function with logging tools like CloudTrail. The third incorrectly places it in the realm of network configuration.",
        "analogy": "IAM Access Analyzer acts like a security inspector who reviews the guest list for your party (resource policy) to ensure no uninvited guests (unintended access) are present."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "IAM_ACCESS_ANALYZER",
        "DDB_SECURITY"
      ]
    },
    {
      "question_text": "What is the relationship between resource-level permissions and resource-based policies?",
      "correct_answer": "Resource-level permissions refer to the ability to specify individual resources (using ARNs) within a policy, while resource-based policies are policies attached directly to a resource.",
      "distractors": [
        {
          "text": "Resource-based policies are the same as resource-level permissions; both are attached to resources.",
          "misconception": "Targets [terminology confusion]: Equates two distinct but related concepts."
        },
        {
          "text": "Resource-level permissions are used to define identity-based policies, while resource-based policies are attached to resources.",
          "misconception": "Targets [misapplication]: Incorrectly links resource-level permissions to identity-based policies."
        },
        {
          "text": "Resource-based policies grant resource-level permissions, and are the only way to achieve them.",
          "misconception": "Targets [exclusivity confusion]: Resource-based policies are one mechanism, but resource-level permissions can also be specified in identity-based policies."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Resource-level permissions allow you to specify individual resources (e.g., a specific DynamoDB table using its ARN) within a policy statement. Resource-based policies are a type of policy that is attached directly to a resource. While resource-based policies often utilize resource-level permissions, the concepts are distinct; resource-level permissions can also be used within identity-based policies.",
        "distractor_analysis": "The first distractor conflates the two terms. The second incorrectly associates resource-level permissions with identity-based policies. The third incorrectly claims resource-based policies are the sole method for achieving resource-level permissions.",
        "analogy": "Resource-level permissions are like specifying the exact street address (ARN) of a house you want to grant access to. A resource-based policy is like the deed or security sign posted directly on that specific house, granting access. An identity-based policy could be like a master key that allows access to multiple houses at specific addresses."
      },
      "code_snippets": [],
      "difficulty": "expert",
      "question_type": "comparison",
      "bloom_level": "analyze",
      "prerequisites": [
        "IAM_ARNS",
        "IAM_POLICY_TYPES"
      ]
    },
    {
      "question_text": "Consider a scenario where a developer needs temporary access to a production DynamoDB table for debugging. Which approach BEST aligns with security best practices using resource-based policies?",
      "correct_answer": "Grant temporary, least-privilege permissions via a resource-based policy attached to the table, and ensure it expires or is revoked promptly.",
      "distractors": [
        {
          "text": "Grant broad administrative access to the developer's IAM role for the duration of the debugging session.",
          "misconception": "Targets [anti-pattern]: Granting broad access, even temporarily, violates least privilege."
        },
        {
          "text": "Modify the table's resource-based policy to allow access for all developers indefinitely.",
          "misconception": "Targets [overly permissive policy]: Granting indefinite access to multiple users is a security risk."
        },
        {
          "text": "Ask the developer to use the root user account for debugging to ensure they have all necessary permissions.",
          "misconception": "Targets [root user misuse]: Using the root user for daily tasks or debugging is a critical security anti-pattern."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Security best practices, including least privilege and temporary access, dictate granting minimal necessary permissions for a limited time. For debugging a production DynamoDB table, a resource-based policy should be crafted to grant only the required actions (e.g., read, specific writes) and then promptly revoked or set to expire, avoiding broad or indefinite access.",
        "distractor_analysis": "The first distractor violates least privilege. The second creates an overly permissive and permanent policy. The third promotes the dangerous practice of using the root user account.",
        "analogy": "It's like giving a temporary, limited-access key card to a repair person that only opens the specific room they need to work in, and collecting the card immediately after they finish, rather than giving them a master key for the whole building."
      },
      "code_snippets": [],
      "difficulty": "expert",
      "question_type": "scenario",
      "bloom_level": "apply",
      "prerequisites": [
        "LEAST_PRIVILEGE",
        "TEMPORARY_ACCESS",
        "DDB_SECURITY"
      ]
    },
    {
      "question_text": "When analyzing cross-account access activity using IAM Access Analyzer for resource-based policies, what is a key output or insight provided?",
      "correct_answer": "Identification of resources that are accessible from outside the trusted account, highlighting potential security risks.",
      "distractors": [
        {
          "text": "A list of all IAM users and roles within the account and their associated permissions.",
          "misconception": "Targets [scope confusion]: This describes identity management tools, not Access Analyzer's focus on resource access grants."
        },
        {
          "text": "Recommendations for optimizing DynamoDB table performance and cost.",
          "misconception": "Targets [domain confusion]: Access Analyzer is for security policy analysis, not performance tuning."
        },
        {
          "text": "Automated generation of CloudFormation templates for resource deployment.",
          "misconception": "Targets [function confusion]: Access Analyzer does not generate deployment templates."
        }
      ],
      "detailed_explanation": {
        "core_logic": "IAM Access Analyzer's primary function is to identify resources that are shared with external entities, including other AWS accounts or the public. It analyzes resource-based policies to pinpoint unintended access grants, thereby helping organizations secure their resources by understanding and mitigating external exposure.",
        "distractor_analysis": "The first distractor describes identity inventory. The second relates to performance optimization. The third is about infrastructure as code, unrelated to Access Analyzer's security function.",
        "analogy": "IAM Access Analyzer is like a security guard checking the visitor log for your building to see who from outside has been granted entry, flagging any unauthorized or unexpected visitors."
      },
      "code_snippets": [],
      "difficulty": "advanced",
      "question_type": "analysis",
      "bloom_level": "analyze",
      "prerequisites": [
        "IAM_ACCESS_ANALYZER",
        "CROSS_ACCOUNT_ACCESS"
      ]
    },
    {
      "question_text": "Which statement accurately describes the difference between identity-based policies and resource-based policies in AWS?",
      "correct_answer": "Identity-based policies are attached to an IAM identity (user, role, group), defining what that identity can do, while resource-based policies are attached to a resource, defining who can access that resource.",
      "distractors": [
        {
          "text": "Identity-based policies define what actions can be performed on a resource, while resource-based policies define what resources an identity can access.",
          "misconception": "Targets [role reversal]: Incorrectly swaps the primary focus of each policy type."
        },
        {
          "text": "Identity-based policies are always explicit denies, while resource-based policies are always explicit allows.",
          "misconception": "Targets [logic confusion]: Both policy types can contain explicit allows and denies."
        },
        {
          "text": "Resource-based policies are managed policies, while identity-based policies are always inline.",
          "misconception": "Targets [management type confusion]: Resource-based policies are typically inline, while identity-based policies can be managed or inline."
        }
      ],
      "detailed_explanation": {
        "core_logic": "Identity-based policies are attached to IAM principals (users, groups, roles) and define the permissions those principals have. Resource-based policies are attached to AWS resources (like S3 buckets or DynamoDB tables) and define which principals are allowed to access that resource and perform specific actions on it.",
        "distractor_analysis": "The first distractor reverses the core function of each policy type. The second incorrectly assigns explicit deny/allow logic. The third mischaracterizes the management type for both policies.",
        "analogy": "An identity-based policy is like your employee ID badge, stating what you're allowed to do in the company. A resource-based policy is like a sign on a specific room's door, stating who is allowed to enter that room."
      },
      "code_snippets": [],
      "difficulty": "intermediate",
      "question_type": "comparison",
      "bloom_level": "analyze",
      "prerequisites": [
        "IAM_POLICY_TYPES",
        "AWS_SECURITY_MODEL"
      ]
    }
  ],
  "generation_metadata": {
    "model": "google/gemini-2.5-flash-lite",
    "num_generated": 16,
    "temperature": 0.1,
    "web_citations": [],
    "research_method": "openrouter_web_plugin",
    "search_query": "Resource-Based Policies 008_Application Security best practices",
    "latency_ms": 27144.933999999997
  },
  "timestamp": "2026-01-18T12:00:21.281559"
}