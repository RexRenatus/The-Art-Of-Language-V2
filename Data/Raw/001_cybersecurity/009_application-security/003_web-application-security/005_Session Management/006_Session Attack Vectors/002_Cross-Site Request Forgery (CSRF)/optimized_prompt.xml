<?xml version="1.0" encoding="UTF-8"?>
<topic_prompt version="2.0">
  <metadata>
    <topic_title>Cross-Site Request Forgery (CSRF)</topic_title>
    <hierarchy>
      <category>Cybersecurity</category>
      <domain>008_Application Security</domain>
      <subdomain>Web 008_Application Security</subdomain>
      <entry_domain>005_Session Management</entry_domain>
      <entry_subdomain>Session Attack Vectors</entry_subdomain>
    </hierarchy>
    <voting_summary>
      <consensus>True</consensus>
      <approval>100.0%</approval>
      <voters>7</voters>
    </voting_summary>
    <generation_timestamp>2026-01-18T12:06:14.731318</generation_timestamp>
  </metadata>
  <learning_objectives level="bloom_taxonomy">
    <objective level="remember" measurable="true">Define Cross-Site Request Forgery (CSRF) and list its key components, including exploited browser behaviors like automatic cookie transmission.</objective>
    <objective level="understand" measurable="true">Explain how CSRF exploits the trust a web application has in an authenticated user's browser, particularly with state-changing requests (e.g., POST, PUT).</objective>
    <objective level="apply" measurable="true">Identify CSRF vulnerabilities in provided sample code snippets involving session cookies and HTTP requests.</objective>
    <objective level="analyze" measurable="true">Compare and contrast CSRF attacks with Cross-Site Scripting (XSS), highlighting how XSS can bypass CSRF protections.</objective>
    <objective level="evaluate" measurable="true">Critique the effectiveness of OWASP-recommended CSRF mitigations, such as synchronizer tokens, SameSite cookies, and double-submit cookies, in different scenarios.</objective>
    <objective level="create" measurable="true">Design a CSRF protection implementation for a sample web application, integrating multiple mitigation strategies and justifying choices.</objective>
  </learning_objectives>
  <active_learning>
    <discussion_prompt>In a group discussion, debate the relative strengths and weaknesses of SameSite cookies versus synchronizer tokens for CSRF prevention in modern web apps. Consider browser compatibility, implementation complexity, and edge cases like subdomains. Support arguments with OWASP Cheat Sheet references.</discussion_prompt>
    <peer_teaching>Explain the key concepts to a partner without using technical jargon.</peer_teaching>
    <problem_solving>Given a scenario, apply the framework to solve the problem.</problem_solving>
  </active_learning>
  <scaffolding>
    <layer level="1" name="Foundation">
      <focus>Basic terminology and definitions</focus>
      <content/>
    </layer>
    <layer level="2" name="Components">
      <focus>Framework components and structure</focus>
      <content/>
    </layer>
    <layer level="3" name="Implementation">
      <focus>Practical implementation steps</focus>
      <content/>
    </layer>
    <layer level="4" name="Integration">
      <focus>Advanced integration and optimization</focus>
      <content/>
    </layer>
  </scaffolding>
  <flashcard_generation>
    <output_schema>
      <field name="question" type="string"/>
      <field name="correct_answer" type="string"/>
      <field name="distractors" type="[{'text': 'string', 'explanation': 'string'}]"/>
      <field name="explanation" type="string"/>
      <field name="bloom_level" type="enum"/>
      <field name="topic_hierarchy" type="object"/>
    </output_schema>
    <distractor_protocol>
      <step number="1">D</step>
      <step number="2">i</step>
      <step number="3">s</step>
      <step number="4">t</step>
      <step number="5">r</step>
      <step number="6">a</step>
      <step number="7">c</step>
      <step number="8">t</step>
      <step number="9">o</step>
      <step number="10">r</step>
      <step number="11">s</step>
      <step number="12"> </step>
      <step number="13">m</step>
      <step number="14">u</step>
      <step number="15">s</step>
      <step number="16">t</step>
      <step number="17"> </step>
      <step number="18">b</step>
      <step number="19">e</step>
      <step number="20">:</step>
      <step number="21"> </step>
      <step number="22">1</step>
      <step number="23">)</step>
      <step number="24"> </step>
      <step number="25">S</step>
      <step number="26">e</step>
      <step number="27">m</step>
      <step number="28">a</step>
      <step number="29">n</step>
      <step number="30">t</step>
      <step number="31">i</step>
      <step number="32">c</step>
      <step number="33">a</step>
      <step number="34">l</step>
      <step number="35">l</step>
      <step number="36">y</step>
      <step number="37"> </step>
      <step number="38">c</step>
      <step number="39">l</step>
      <step number="40">o</step>
      <step number="41">s</step>
      <step number="42">e</step>
      <step number="43"> </step>
      <step number="44">(</step>
      <step number="45">e</step>
      <step number="46">.</step>
      <step number="47">g</step>
      <step number="48">.</step>
      <step number="49">,</step>
      <step number="50"> </step>
      <step number="51">s</step>
      <step number="52">w</step>
      <step number="53">a</step>
      <step number="54">p</step>
      <step number="55"> </step>
      <step number="56">C</step>
      <step number="57">S</step>
      <step number="58">R</step>
      <step number="59">F</step>
      <step number="60">/</step>
      <step number="61">X</step>
      <step number="62">S</step>
      <step number="63">S</step>
      <step number="64">)</step>
      <step number="65">.</step>
      <step number="66"> </step>
      <step number="67">2</step>
      <step number="68">)</step>
      <step number="69"> </step>
      <step number="70">B</step>
      <step number="71">a</step>
      <step number="72">s</step>
      <step number="73">e</step>
      <step number="74">d</step>
      <step number="75"> </step>
      <step number="76">o</step>
      <step number="77">n</step>
      <step number="78"> </step>
      <step number="79">r</step>
      <step number="80">e</step>
      <step number="81">a</step>
      <step number="82">l</step>
      <step number="83"> </step>
      <step number="84">c</step>
      <step number="85">o</step>
      <step number="86">n</step>
      <step number="87">f</step>
      <step number="88">u</step>
      <step number="89">s</step>
      <step number="90">i</step>
      <step number="91">o</step>
      <step number="92">n</step>
      <step number="93">s</step>
      <step number="94"> </step>
      <step number="95">(</step>
      <step number="96">e</step>
      <step number="97">.</step>
      <step number="98">g</step>
      <step number="99">.</step>
      <step number="100">,</step>
      <step number="101"> </step>
      <step number="102">'</step>
      <step number="103">G</step>
      <step number="104">E</step>
      <step number="105">T</step>
      <step number="106"> </step>
      <step number="107">r</step>
      <step number="108">e</step>
      <step number="109">q</step>
      <step number="110">u</step>
      <step number="111">e</step>
      <step number="112">s</step>
      <step number="113">t</step>
      <step number="114">s</step>
      <step number="115"> </step>
      <step number="116">a</step>
      <step number="117">r</step>
      <step number="118">e</step>
      <step number="119"> </step>
      <step number="120">s</step>
      <step number="121">a</step>
      <step number="122">f</step>
      <step number="123">e</step>
      <step number="124">'</step>
      <step number="125">)</step>
      <step number="126">.</step>
      <step number="127"> </step>
      <step number="128">3</step>
      <step number="129">)</step>
      <step number="130"> </step>
      <step number="131">N</step>
      <step number="132">e</step>
      <step number="133">v</step>
      <step number="134">e</step>
      <step number="135">r</step>
      <step number="136"> </step>
      <step number="137">r</step>
      <step number="138">e</step>
      <step number="139">v</step>
      <step number="140">e</step>
      <step number="141">a</step>
      <step number="142">l</step>
      <step number="143"> </step>
      <step number="144">c</step>
      <step number="145">o</step>
      <step number="146">r</step>
      <step number="147">r</step>
      <step number="148">e</step>
      <step number="149">c</step>
      <step number="150">t</step>
      <step number="151"> </step>
      <step number="152">a</step>
      <step number="153">n</step>
      <step number="154">s</step>
      <step number="155">w</step>
      <step number="156">e</step>
      <step number="157">r</step>
      <step number="158">.</step>
      <step number="159"> </step>
      <step number="160">E</step>
      <step number="161">x</step>
      <step number="162">p</step>
      <step number="163">l</step>
      <step number="164">a</step>
      <step number="165">n</step>
      <step number="166">a</step>
      <step number="167">t</step>
      <step number="168">i</step>
      <step number="169">o</step>
      <step number="170">n</step>
      <step number="171">s</step>
      <step number="172">:</step>
      <step number="173"> </step>
      <step number="174">1</step>
      <step number="175">-</step>
      <step number="176">2</step>
      <step number="177"> </step>
      <step number="178">s</step>
      <step number="179">e</step>
      <step number="180">n</step>
      <step number="181">t</step>
      <step number="182">e</step>
      <step number="183">n</step>
      <step number="184">c</step>
      <step number="185">e</step>
      <step number="186">s</step>
      <step number="187"> </step>
      <step number="188">w</step>
      <step number="189">h</step>
      <step number="190">y</step>
      <step number="191"> </step>
      <step number="192">w</step>
      <step number="193">r</step>
      <step number="194">o</step>
      <step number="195">n</step>
      <step number="196">g</step>
      <step number="197">,</step>
      <step number="198"> </step>
      <step number="199">l</step>
      <step number="200">i</step>
      <step number="201">n</step>
      <step number="202">k</step>
      <step number="203">i</step>
      <step number="204">n</step>
      <step number="205">g</step>
      <step number="206"> </step>
      <step number="207">t</step>
      <step number="208">o</step>
      <step number="209"> </step>
      <step number="210">k</step>
      <step number="211">e</step>
      <step number="212">y</step>
      <step number="213"> </step>
      <step number="214">c</step>
      <step number="215">o</step>
      <step number="216">n</step>
      <step number="217">c</step>
      <step number="218">e</step>
      <step number="219">p</step>
      <step number="220">t</step>
      <step number="221">.</step>
    </distractor_protocol>
    <system_prompt>You are an expert flashcard generator for cybersecurity education, specializing in Application Security. Topic: Cross-Site Request Forgery (CSRF) in Web 008_Application Security, under Session Attack Vectors (hierarchy: Cybersecurity &gt; 008_Application Security &gt; Web 008_Application Security &gt; 005_Session Management &gt; Session Attack Vectors &gt; CSRF). Use provided research context, OWASP prevention strategies (synchronizer tokens, SameSite cookies, double-submit cookies), and voter consensus for completeness.
Incorporate:
- Learning objectives (span Bloom's: remember/define CSRF; understand/exploit browser cookies; apply/identify in code; analyze/compare XSS; evaluate/critique mitigations; create/design protections).
- Active learning for deeper recall (inspired by discussions, peer teaching, problem-solving).
- Scaffolding: Generate flashcards progressively across 4 layers (layer_1_foundation: prereqs/defs; layer_2_components: flows/relations; layer_3_implementation: attacks/defenses; layer_4_integration: XSS/session links).
Output ONLY a JSON array of 25 flashcards. Strictly follow flashcard_schema: snake_case keys, exactly 3 distractors + distractor_explanations, full fields. Ensure even distribution: 20% layer1, 25% layer2, 30% layer3, 25% layer4; Bloom's progression. Questions active/pedagogical (e.g., 'In code X, why vulnerable?'). Explanations reference OWASP Cheat Sheet, include why distractors wrong. Sources: OWASP CSRF Prevention Cheat Sheet, provided research.
Example flashcard structure:
{
  "question": "What does CSRF exploit?",
  "correct_answer": "Trust in user's browser",
  "distractors": ["Trust in website", "User input", "Network latency"],
  "distractor_explanations": ["Confuses with XSS", "Relates to injection", "Not security-relevant"],
  "explanation": "CSRF uses auto-sent cookies... (Bloom: understand, layer:1)",
  "bloom_level": "understand",
  "scaffolding_layer": "layer_1_foundation",
  "prerequisite_tags": ["session_cookies"]
}</system_prompt>
  </flashcard_generation>
</topic_prompt>